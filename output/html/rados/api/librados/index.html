
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Librados (C) &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../../" />
    <link rel="up" title="Ceph 存储集群 API" href="../" />
    <link rel="next" title="LibradosPP (C++)" href="../libradospp/" />
    <link rel="prev" title="librados 简介" href="../librados-intro/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../libradospp/" title="LibradosPP (C++)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../librados-intro/" title="librados 简介"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" accesskey="U">Ceph 存储集群 API</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="librados-c">
<h1>Librados (C)<a class="headerlink" href="#librados-c" title="Permalink to this headline">¶</a></h1>
<p><cite>librados</cite> 提供了 RADOS 服务的底层访问功能， RADOS 概览参见<a class="reference internal" href="../../../architecture/"><em>体系结构</em></a>。</p>
<div class="section" id="id1">
<h2>实例：连接并写入一个对象<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>要使用 <cite>Librados</cite> ，先实例化一个 <a class="reference internal" href="#rados_t" title="rados_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_t</span></tt></a> 变量（集群句柄）、再用指向它的指针调用 c:func:<cite>rados_create()</cite> ：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
<span class="kt">rados_t</span> <span class="n">cluster</span><span class="p">;</span>

<span class="n">err</span> <span class="o">=</span> <span class="n">rados_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cluster</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot create a cluster handle: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后配置 <a class="reference internal" href="#rados_t" title="rados_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_t</span></tt></a> 以连接集群，可以挨个配置（ <a class="reference internal" href="#rados_conf_set" title="rados_conf_set"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_set()</span></tt></a> ）、或用配置文件（ <a class="reference internal" href="#rados_conf_read_file" title="rados_conf_read_file"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_read_file()</span></tt></a> ）、或命令行选项（ <a class="reference internal" href="#rados_conf_parse_argv" title="rados_conf_parse_argv"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_parse_argv()</span></tt></a> ）、或环境变量（ <a class="reference internal" href="#rados_conf_parse_env" title="rados_conf_parse_env"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_parse_env()</span></tt></a> ）：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">err</span> <span class="o">=</span> <span class="n">rados_conf_read_file</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="s">&quot;/path/to/myceph.conf&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot read config file: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>集群句柄配置好后，就可以用 <a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a> 连接了：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">err</span> <span class="o">=</span> <span class="n">rados_connect</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot connect to cluster: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后打开一个“ IO 上下文”，用 <a class="reference internal" href="#rados_ioctx_create" title="rados_ioctx_create"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_create()</span></tt></a> 打开 <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_ioctx_t</span></tt></a> ：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">rados_ioctx_t</span> <span class="n">io</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">poolname</span> <span class="o">=</span> <span class="s">&quot;mypool&quot;</span><span class="p">;</span>

<span class="n">err</span> <span class="o">=</span> <span class="n">rados_ioctx_create</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="n">poolname</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">io</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot open rados pool %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poolname</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>注意，你访问的存储池必须存在。</p>
<p>这时你能用 RADOS 数据修改函数了，例如用 <a class="reference internal" href="#rados_write_full" title="rados_write_full"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_full()</span></tt></a> 写入名为 <tt class="docutils literal"><span class="pre">greeting</span></tt> 的对象：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">err</span> <span class="o">=</span> <span class="n">rados_write_full</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s">&quot;greeting&quot;</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot write pool %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poolname</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>最后，用 <a class="reference internal" href="#rados_ioctx_destroy" title="rados_ioctx_destroy"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_destroy()</span></tt></a> 和 <a class="reference internal" href="#rados_shutdown" title="rados_shutdown"><tt class="xref c c-func docutils literal"><span class="pre">rados_shutdown()</span></tt></a> 分别关闭 IO 上下文、到 RADOS 的连接：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
<span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="io">
<h2>异步 IO<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<p>处理大量 IO 时，通常不必等一个完成再开始下一个。 <cite>Librados</cite> 提供了几种操作的异步版本：</p>
<ul class="simple">
<li><a class="reference internal" href="#rados_aio_write" title="rados_aio_write"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_write()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_append" title="rados_aio_append"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_append()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_write_full" title="rados_aio_write_full"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_write_full()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_read" title="rados_aio_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_read()</span></tt></a></li>
</ul>
<p>对每种操作，都必须先创建一个 <a class="reference internal" href="#rados_completion_t" title="rados_completion_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_completion_t</span></tt></a> 数据结构来表达做什么、何时安全或显式地调用 <a class="reference internal" href="#rados_aio_create_completion" title="rados_aio_create_completion"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_create_completion()</span></tt></a> 来结束，如果没什么特殊需求，可以仅传递 NULL ：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">rados_completion_t</span> <span class="n">comp</span><span class="p">;</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_create_completion</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: could not create aio completion: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>现在你可以调用任意一种异步 IO 操作了，然后等它出现在内存、所有复制所在的硬盘里：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_write</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: could not schedule aio write: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">rados_wait_for_complete</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span> <span class="c1">// in memory</span>
<span class="n">rados_wait_for_safe</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span> <span class="c1">// on disk</span>
</pre></div>
</div>
<p>最后，用 <a class="reference internal" href="#rados_aio_release" title="rados_aio_release"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_release()</span></tt></a> 释放内存：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span>
</pre></div>
</div>
<p>你可以用各种回叫函数告知应用程序何时可以持续写入、或何时读缓冲是满的。例如，如果你追加几个对象时想衡量每个操作的延时，可以调度几个写操作、并把确认和提交时间保存到相应回叫函数，然后用 <a class="reference internal" href="#rados_aio_flush" title="rados_aio_flush"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_flush()</span></tt></a> 等它们完成，然后就可以分析延时了：</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">start</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">ack_end</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">commit_end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">req_duration</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">ack_callback</span><span class="p">(</span><span class="kt">rados_completion_t</span> <span class="n">comp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="o">*</span><span class="n">dur</span> <span class="o">=</span> <span class="p">(</span><span class="n">req_duration</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">;</span>
        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dur</span><span class="o">-&gt;</span><span class="n">ack_end</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">commit_callback</span><span class="p">(</span><span class="kt">rados_completion_t</span> <span class="n">comp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="o">*</span><span class="n">dur</span> <span class="o">=</span> <span class="p">(</span><span class="n">req_duration</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">;</span>
        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dur</span><span class="o">-&gt;</span><span class="n">commit_end</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">output_append_latency</span><span class="p">(</span><span class="kt">rados_ioctx_t</span> <span class="n">io</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">num_writes</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="n">times</span><span class="p">[</span><span class="n">num_writes</span><span class="p">];</span>
        <span class="kt">rados_completion_t</span> <span class="n">comps</span><span class="p">[</span><span class="n">num_writes</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_writes</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
                <span class="kt">int</span> <span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_create_completion</span><span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ack_callback</span><span class="p">,</span> <span class="n">commit_callback</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error creating rados completion: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
                        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kt">char</span> <span class="n">obj_name</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
                <span class="n">snprintf</span><span class="p">(</span><span class="n">obj_name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">obj_name</span><span class="p">),</span> <span class="s">&quot;foo%ld&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">i</span><span class="p">);</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_append</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error from rados_aio_append: %s&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
                        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// wait until all requests finish *and* the callbacks complete</span>
        <span class="n">rados_aio_flush</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="c1">// the latencies can now be analyzed</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Request # | Ack latency (s) | Commit latency (s)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_writes</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// don&#39;t forget to free the completions</span>
                <span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="k">struct</span> <span class="n">timeval</span> <span class="n">ack_lat</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">;</span>
                <span class="n">timersub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ack_end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ack_lat</span><span class="p">);</span>
                <span class="n">timersub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">commit_end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">commit_lat</span><span class="p">);</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%9ld | %8ld.%06ld | %10ld.%06ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">ack_lat</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> <span class="n">ack_lat</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>注意，所有 <a class="reference internal" href="#rados_completion_t" title="rados_completion_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_completion_t</span></tt></a> 都必须用 <a class="reference internal" href="#rados_aio_release" title="rados_aio_release"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_release()</span></tt></a> 释放内存，以免造成内存泄漏。</p>
</div>
<div class="section" id="api-calls">
<h2>API calls<a class="headerlink" href="#api-calls" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="section" id="Struct obj_watch_t">
<h3>Struct obj_watch_t<a class="headerlink" href="#Struct obj_watch_t" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="obj_watch_t">
struct <tt class="descname">obj_watch_t</tt><a class="headerlink" href="#obj_watch_t" title="Permalink to this definition">¶</a></dt>
<dd><p>One item from list_watchers.</p>
</dd></dl>

<div class="section" id="public-attrib">
<h4>Members<a class="headerlink" href="#public-attrib" title="Permalink to this headline">¶</a></h4>
<dl class="member">
<dt id="addr">
char <tt class="descname">addr</tt><a class="headerlink" href="#addr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="watcher_id">
int64_t <tt class="descname">watcher_id</tt><a class="headerlink" href="#watcher_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="cookie">
uint64_t <tt class="descname">cookie</tt><a class="headerlink" href="#cookie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="timeout_seconds">
uint32_t <tt class="descname">timeout_seconds</tt><a class="headerlink" href="#timeout_seconds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="define">
<h3>Defines<a class="headerlink" href="#define" title="Permalink to this headline">¶</a></h3>
<dl class="macro">
<dt id="LIBRADOS_ALL_NSPACES">
<tt class="descname">LIBRADOS_ALL_NSPACES</tt><a class="headerlink" href="#LIBRADOS_ALL_NSPACES" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass as nspace argument to <a class="reference internal" href="#rados_ioctx_set_namespace" title="rados_ioctx_set_namespace"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_set_namespace()</span></tt></a>before calling<a class="reference internal" href="#rados_nobjects_list_open" title="rados_nobjects_list_open"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_open()</span></tt></a>to return all objects in all namespaces.</p>
</dd></dl>

</div>
<div class="section" id="Struct rados_pool_stat_t">
<h3>Struct rados_pool_stat_t<a class="headerlink" href="#Struct rados_pool_stat_t" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="rados_pool_stat_t">
struct <tt class="descname">rados_pool_stat_t</tt><a class="headerlink" href="#rados_pool_stat_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Usage information for a pool.</p>
</dd></dl>

<div class="section" id="public-attrib">
<h4>Members<a class="headerlink" href="#public-attrib" title="Permalink to this headline">¶</a></h4>
<dl class="member">
<dt id="num_bytes">
uint64_t <tt class="descname">num_bytes</tt><a class="headerlink" href="#num_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>space used in bytes</p>
</dd></dl>

<dl class="member">
<dt id="num_kb">
uint64_t <tt class="descname">num_kb</tt><a class="headerlink" href="#num_kb" title="Permalink to this definition">¶</a></dt>
<dd><p>space used in KB</p>
</dd></dl>

<dl class="member">
<dt id="num_objects">
uint64_t <tt class="descname">num_objects</tt><a class="headerlink" href="#num_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects in the pool</p>
</dd></dl>

<dl class="member">
<dt id="num_object_clones">
uint64_t <tt class="descname">num_object_clones</tt><a class="headerlink" href="#num_object_clones" title="Permalink to this definition">¶</a></dt>
<dd><p>number of clones of objects</p>
</dd></dl>

<dl class="member">
<dt id="num_object_copies">
uint64_t <tt class="descname">num_object_copies</tt><a class="headerlink" href="#num_object_copies" title="Permalink to this definition">¶</a></dt>
<dd><p>num_objects * num_replicas</p>
</dd></dl>

<dl class="member">
<dt id="num_objects_missing_on_primary">
uint64_t <tt class="descname">num_objects_missing_on_primary</tt><a class="headerlink" href="#num_objects_missing_on_primary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="num_objects_unfound">
uint64_t <tt class="descname">num_objects_unfound</tt><a class="headerlink" href="#num_objects_unfound" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects found on no OSDs</p>
</dd></dl>

<dl class="member">
<dt id="num_objects_degraded">
uint64_t <tt class="descname">num_objects_degraded</tt><a class="headerlink" href="#num_objects_degraded" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects replicated fewer times than they should be (but found on at least one <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>)</p>
</dd></dl>

<dl class="member">
<dt id="num_rd">
uint64_t <tt class="descname">num_rd</tt><a class="headerlink" href="#num_rd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="num_rd_kb">
uint64_t <tt class="descname">num_rd_kb</tt><a class="headerlink" href="#num_rd_kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="num_wr">
uint64_t <tt class="descname">num_wr</tt><a class="headerlink" href="#num_wr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="num_wr_kb">
uint64_t <tt class="descname">num_wr_kb</tt><a class="headerlink" href="#num_wr_kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="Struct rados_cluster_stat_t">
<h3>Struct rados_cluster_stat_t<a class="headerlink" href="#Struct rados_cluster_stat_t" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="rados_cluster_stat_t">
struct <tt class="descname">rados_cluster_stat_t</tt><a class="headerlink" href="#rados_cluster_stat_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster-wide usage information.</p>
</dd></dl>

<div class="section" id="public-attrib">
<h4>Members<a class="headerlink" href="#public-attrib" title="Permalink to this headline">¶</a></h4>
<dl class="member">
<dt id="kb">
uint64_t <tt class="descname">kb</tt><a class="headerlink" href="#kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="kb_used">
uint64_t <tt class="descname">kb_used</tt><a class="headerlink" href="#kb_used" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt id="kb_avail">
uint64_t <tt class="descname">kb_avail</tt><a class="headerlink" href="#kb_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="member">
<dt>
uint64_t <tt class="descname">num_objects</tt></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="define">
<h3>Defines<a class="headerlink" href="#define" title="Permalink to this headline">¶</a></h3>
<dl class="macro">
<dt id="CEPH_OSD_TMAP_HDR">
<tt class="descname">CEPH_OSD_TMAP_HDR</tt><a class="headerlink" href="#CEPH_OSD_TMAP_HDR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="CEPH_OSD_TMAP_SET">
<tt class="descname">CEPH_OSD_TMAP_SET</tt><a class="headerlink" href="#CEPH_OSD_TMAP_SET" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="CEPH_OSD_TMAP_CREATE">
<tt class="descname">CEPH_OSD_TMAP_CREATE</tt><a class="headerlink" href="#CEPH_OSD_TMAP_CREATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="CEPH_OSD_TMAP_RM">
<tt class="descname">CEPH_OSD_TMAP_RM</tt><a class="headerlink" href="#CEPH_OSD_TMAP_RM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_VER_MAJOR">
<tt class="descname">LIBRADOS_VER_MAJOR</tt><a class="headerlink" href="#LIBRADOS_VER_MAJOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_VER_MINOR">
<tt class="descname">LIBRADOS_VER_MINOR</tt><a class="headerlink" href="#LIBRADOS_VER_MINOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_VER_EXTRA">
<tt class="descname">LIBRADOS_VER_EXTRA</tt><a class="headerlink" href="#LIBRADOS_VER_EXTRA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_VERSION">
<tt class="descname">LIBRADOS_VERSION</tt><a class="headerlink" href="#LIBRADOS_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_VERSION_CODE">
<tt class="descname">LIBRADOS_VERSION_CODE</tt><a class="headerlink" href="#LIBRADOS_VERSION_CODE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_SUPPORTS_WATCH">
<tt class="descname">LIBRADOS_SUPPORTS_WATCH</tt><a class="headerlink" href="#LIBRADOS_SUPPORTS_WATCH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_LOCK_FLAG_RENEW">
<tt class="descname">LIBRADOS_LOCK_FLAG_RENEW</tt><a class="headerlink" href="#LIBRADOS_LOCK_FLAG_RENEW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_CREATE_EXCLUSIVE">
<tt class="descname">LIBRADOS_CREATE_EXCLUSIVE</tt><a class="headerlink" href="#LIBRADOS_CREATE_EXCLUSIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_CREATE_IDEMPOTENT">
<tt class="descname">LIBRADOS_CREATE_IDEMPOTENT</tt><a class="headerlink" href="#LIBRADOS_CREATE_IDEMPOTENT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_OP_FLAG_EXCL">
<tt class="descname">LIBRADOS_OP_FLAG_EXCL</tt><a class="headerlink" href="#LIBRADOS_OP_FLAG_EXCL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_OP_FLAG_FAILOK">
<tt class="descname">LIBRADOS_OP_FLAG_FAILOK</tt><a class="headerlink" href="#LIBRADOS_OP_FLAG_FAILOK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_SNAP_HEAD">
<tt class="descname">LIBRADOS_SNAP_HEAD</tt><a class="headerlink" href="#LIBRADOS_SNAP_HEAD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="macro">
<dt id="LIBRADOS_SNAP_DIR">
<tt class="descname">LIBRADOS_SNAP_DIR</tt><a class="headerlink" href="#LIBRADOS_SNAP_DIR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="typedef">
<h3>Types<a class="headerlink" href="#typedef" title="Permalink to this headline">¶</a></h3>
<dl class="type">
<dt id="rados_t">
<tt class="descname">rados_t</tt><a class="headerlink" href="#rados_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A handle for interacting with a RADOS cluster.</p>
<p>It encapsulates all RADOS client configuration, including username, key for authentication, logging, and debugging. Talking different clusters <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;ndash&#8217;</p>
<pre class="last literal-block">
&lt;ndash xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;/&gt; or to the same cluster with different users
</pre>
</div>
or to the same cluster with different users<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;ndash&#8217;</p>
<pre class="last literal-block">
&lt;ndash xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;/&gt; requires different cluster handles.
</pre>
</div>
requires different cluster handles.</p>
</dd></dl>

<dl class="type">
<dt id="rados_config_t">
<tt class="descname">rados_config_t</tt><a class="headerlink" href="#rados_config_t" title="Permalink to this definition">¶</a></dt>
<dd><p>rados_config_t</p>
<p>A handle for the ceph configuration context for the rados_t cluster instance. This can be used to share configuration context/state (e.g., logging configuration) between librados instance.</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The config context does not have independent reference counting. As such, a rados_config_t handle retrieved from a given rados_t is only valid as long as that rados_t.</p>
</div>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_ioctx_t">
<tt class="descname">rados_ioctx_t</tt><a class="headerlink" href="#rados_ioctx_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An io context encapsulates a few settings for all I/O operations done on it:</p>
<p><ul class="simple">
<li>pool - set when the io context is created (see <a class="reference internal" href="#rados_ioctx_create" title="rados_ioctx_create"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_create()</span></tt></a>)</li>
<li>snapshot context for writes (see <a class="reference internal" href="#rados_ioctx_selfmanaged_snap_set_write_ctx" title="rados_ioctx_selfmanaged_snap_set_write_ctx"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_selfmanaged_snap_set_write_ctx()</span></tt></a>)</li>
<li>snapshot id to read from (see <a class="reference internal" href="#rados_ioctx_snap_set_read" title="rados_ioctx_snap_set_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_snap_set_read()</span></tt></a>)</li>
<li>object locator for all single-object operations (see <a class="reference internal" href="#rados_ioctx_locator_set_key" title="rados_ioctx_locator_set_key"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_locator_set_key()</span></tt></a>)</li>
<li>namespace for all single-object operations (see <a class="reference internal" href="#rados_ioctx_set_namespace" title="rados_ioctx_set_namespace"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_set_namespace()</span></tt></a>). Set to LIBRADOS_ALL_NSPACES before<a class="reference internal" href="#rados_nobjects_list_open" title="rados_nobjects_list_open"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_open()</span></tt></a>will list all objects in all namespaces.</li>
</ul>
</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Changing any of these settings is not thread-safe - librados users must synchronize any of these changes on their own, or use separate io contexts for each thread</p>
</div>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_list_ctx_t">
<tt class="descname">rados_list_ctx_t</tt><a class="headerlink" href="#rados_list_ctx_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing the objects in a pool.</p>
<p>Used with <a class="reference internal" href="#rados_nobjects_list_open" title="rados_nobjects_list_open"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_open()</span></tt></a>,<a class="reference internal" href="#rados_nobjects_list_next" title="rados_nobjects_list_next"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_next()</span></tt></a>, and<a class="reference internal" href="#rados_nobjects_list_close" title="rados_nobjects_list_close"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_close()</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="rados_snap_t">
<tt class="descname">rados_snap_t</tt><a class="headerlink" href="#rados_snap_t" title="Permalink to this definition">¶</a></dt>
<dd><p>The id of a snapshot.</p>
</dd></dl>

<dl class="type">
<dt id="rados_xattrs_iter_t">
<tt class="descname">rados_xattrs_iter_t</tt><a class="headerlink" href="#rados_xattrs_iter_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing extended attrbutes on an object.</p>
<p>Used with <a class="reference internal" href="#rados_getxattrs" title="rados_getxattrs"><tt class="xref c c-func docutils literal"><span class="pre">rados_getxattrs()</span></tt></a>,<a class="reference internal" href="#rados_getxattrs_next" title="rados_getxattrs_next"><tt class="xref c c-func docutils literal"><span class="pre">rados_getxattrs_next()</span></tt></a>, and<a class="reference internal" href="#rados_getxattrs_end" title="rados_getxattrs_end"><tt class="xref c c-func docutils literal"><span class="pre">rados_getxattrs_end()</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="rados_omap_iter_t">
<tt class="descname">rados_omap_iter_t</tt><a class="headerlink" href="#rados_omap_iter_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing omap key/value pairs on an object.</p>
<p>Used with <a class="reference internal" href="#rados_read_op_omap_get_keys" title="rados_read_op_omap_get_keys"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_keys()</span></tt></a>,<a class="reference internal" href="#rados_read_op_omap_get_vals" title="rados_read_op_omap_get_vals"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_vals()</span></tt></a>,<a class="reference internal" href="#rados_read_op_omap_get_vals_by_keys" title="rados_read_op_omap_get_vals_by_keys"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_vals_by_keys()</span></tt></a>,<a class="reference internal" href="#rados_omap_get_next" title="rados_omap_get_next"><tt class="xref c c-func docutils literal"><span class="pre">rados_omap_get_next()</span></tt></a>, and<a class="reference internal" href="#rados_omap_get_end" title="rados_omap_get_end"><tt class="xref c c-func docutils literal"><span class="pre">rados_omap_get_end()</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="rados_write_op_t">
<tt class="descname">rados_write_op_t</tt><a class="headerlink" href="#rados_write_op_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An object write operation stores a number of operations which can be executed atomically.</p>
<p>For usage, see:<ul class="simple">
<li>Creation and deletion: <a class="reference internal" href="#rados_create_write_op" title="rados_create_write_op"><tt class="xref c c-func docutils literal"><span class="pre">rados_create_write_op()</span></tt></a><a class="reference internal" href="#rados_release_write_op" title="rados_release_write_op"><tt class="xref c c-func docutils literal"><span class="pre">rados_release_write_op()</span></tt></a></li>
<li>Extended attribute manipulation: <a class="reference internal" href="#rados_write_op_cmpxattr" title="rados_write_op_cmpxattr"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_cmpxattr()</span></tt></a><a class="reference internal" href="#rados_write_op_cmpxattr" title="rados_write_op_cmpxattr"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_cmpxattr()</span></tt></a>,<a class="reference internal" href="#rados_write_op_setxattr" title="rados_write_op_setxattr"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_setxattr()</span></tt></a>,<a class="reference internal" href="#rados_write_op_rmxattr" title="rados_write_op_rmxattr"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_rmxattr()</span></tt></a></li>
<li>Object map key/value pairs: <a class="reference internal" href="#rados_write_op_omap_set" title="rados_write_op_omap_set"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_omap_set()</span></tt></a>,<a class="reference internal" href="#rados_write_op_omap_rm_keys" title="rados_write_op_omap_rm_keys"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_omap_rm_keys()</span></tt></a>,<a class="reference internal" href="#rados_write_op_omap_clear" title="rados_write_op_omap_clear"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_omap_clear()</span></tt></a>,<a class="reference internal" href="#rados_write_op_omap_cmp" title="rados_write_op_omap_cmp"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_omap_cmp()</span></tt></a></li>
<li>Creating objects: <a class="reference internal" href="#rados_write_op_create" title="rados_write_op_create"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_create()</span></tt></a></li>
<li>IO on objects: <a class="reference internal" href="#rados_write_op_append" title="rados_write_op_append"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_append()</span></tt></a>,<a class="reference internal" href="#rados_write_op_write" title="rados_write_op_write"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_write()</span></tt></a>, rados_write_op_zero<a class="reference internal" href="#rados_write_op_write_full" title="rados_write_op_write_full"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_write_full()</span></tt></a>, rados_write_op_remove,<a class="reference internal" href="#rados_write_op_truncate" title="rados_write_op_truncate"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_truncate()</span></tt></a>,<a class="reference internal" href="#rados_write_op_zero" title="rados_write_op_zero"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_zero()</span></tt></a></li>
<li>Hints: <a class="reference internal" href="#rados_write_op_set_alloc_hint" title="rados_write_op_set_alloc_hint"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_set_alloc_hint()</span></tt></a></li>
<li>Performing the operation: <a class="reference internal" href="#rados_write_op_operate" title="rados_write_op_operate"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_op_operate()</span></tt></a>,<a class="reference internal" href="#rados_aio_write_op_operate" title="rados_aio_write_op_operate"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_write_op_operate()</span></tt></a></li>
</ul>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_read_op_t">
<tt class="descname">rados_read_op_t</tt><a class="headerlink" href="#rados_read_op_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An object read operation stores a number of operations which can be executed atomically.</p>
<p>For usage, see:<ul class="simple">
<li>Creation and deletion: <a class="reference internal" href="#rados_create_read_op" title="rados_create_read_op"><tt class="xref c c-func docutils literal"><span class="pre">rados_create_read_op()</span></tt></a><a class="reference internal" href="#rados_release_read_op" title="rados_release_read_op"><tt class="xref c c-func docutils literal"><span class="pre">rados_release_read_op()</span></tt></a></li>
<li>Extended attribute manipulation: <a class="reference internal" href="#rados_read_op_cmpxattr" title="rados_read_op_cmpxattr"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_cmpxattr()</span></tt></a>, rados_read_op_getxattr(),<a class="reference internal" href="#rados_read_op_getxattrs" title="rados_read_op_getxattrs"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_getxattrs()</span></tt></a></li>
<li>Object map key/value pairs: <a class="reference internal" href="#rados_read_op_omap_get_vals" title="rados_read_op_omap_get_vals"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_vals()</span></tt></a>,<a class="reference internal" href="#rados_read_op_omap_get_keys" title="rados_read_op_omap_get_keys"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_keys()</span></tt></a>,<a class="reference internal" href="#rados_read_op_omap_get_vals_by_keys" title="rados_read_op_omap_get_vals_by_keys"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_get_vals_by_keys()</span></tt></a>,<a class="reference internal" href="#rados_read_op_omap_cmp" title="rados_read_op_omap_cmp"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_omap_cmp()</span></tt></a></li>
<li>Object properties: <a class="reference internal" href="#rados_read_op_stat" title="rados_read_op_stat"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_stat()</span></tt></a>,<a class="reference internal" href="#rados_read_op_assert_exists" title="rados_read_op_assert_exists"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_assert_exists()</span></tt></a></li>
<li>IO on objects: <a class="reference internal" href="#rados_read_op_read" title="rados_read_op_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_read()</span></tt></a></li>
<li>Custom operations: <a class="reference internal" href="#rados_read_op_exec" title="rados_read_op_exec"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_exec()</span></tt></a>,<a class="reference internal" href="#rados_read_op_exec_user_buf" title="rados_read_op_exec_user_buf"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_exec_user_buf()</span></tt></a></li>
<li>Request properties: <a class="reference internal" href="#rados_read_op_set_flags" title="rados_read_op_set_flags"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_set_flags()</span></tt></a></li>
<li>Performing the operation: <a class="reference internal" href="#rados_read_op_operate" title="rados_read_op_operate"><tt class="xref c c-func docutils literal"><span class="pre">rados_read_op_operate()</span></tt></a>,<a class="reference internal" href="#rados_aio_read_op_operate" title="rados_aio_read_op_operate"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_read_op_operate()</span></tt></a></li>
</ul>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_completion_t">
<tt class="descname">rados_completion_t</tt><a class="headerlink" href="#rados_completion_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the state of an asynchronous operation - it contains the return value once the operation completes, and can be used to block until the operation is complete or safe.</p>
</dd></dl>

<dl class="type">
<dt id="rados_callback_t">
<tt class="descname">rados_callback_t</tt><a class="headerlink" href="#rados_callback_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callbacks for asynchrous operations take two parameters:</p>
<p><ul class="simple">
<li>cb the completion that has finished</li>
<li>arg application defined data made available to the callback function</li>
</ul>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_watchcb_t">
<tt class="descname">rados_watchcb_t</tt><a class="headerlink" href="#rados_watchcb_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback activated when a notify is received on a watched object.</p>
<p>Parameters are:<ul class="simple">
<li>opcode undefined</li>
<li>ver version of the watched object</li>
<li>arg application-specific data</li>
</ul>
</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: opcode is an internal detail that shouldn&#8217;t be exposed</p>
</div>
</p>
</dd></dl>

<dl class="type">
<dt id="rados_log_callback_t">
<tt class="descname">rados_log_callback_t</tt><a class="headerlink" href="#rados_log_callback_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="func">
<h3>Functions<a class="headerlink" href="#func" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="rados_version">
void <tt class="descname">rados_version</tt><big>(</big>int<em>&nbsp;*major</em>, int<em>&nbsp;*minor</em>, int<em>&nbsp;*extra</em><big>)</big><a class="headerlink" href="#rados_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the version of librados.</p>
<p>The version number is major.minor.extra. Note that this is unrelated to the Ceph version number.</p>
<p>TODO: define version semantics, i.e.:<ul class="simple">
<li>incrementing major is for backwards-incompatible changes</li>
<li>incrementing minor is for backwards-compatible changes</li>
<li>incrementing extra is for bug fixes</li>
</ul>
</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>major</strong> &#8211; where to store the major version number</li>
<li><strong>minor</strong> &#8211; where to store the minor version number</li>
<li><strong>extra</strong> &#8211; where to store the extra version number</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_create">
int <tt class="descname">rados_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;*cluster</em>, const char *const<em>&nbsp;id</em><big>)</big><a class="headerlink" href="#rados_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a handle for communicating with a RADOS cluster.</p>
<p>Ceph environment variables are read when this is called, so if $CEPH_ARGS specifies everything you need to connect, no further configuration is necessary.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; where to store the handle</li>
<li><strong>id</strong> &#8211; the user to connect as (i.e. admin, not client.admin)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_create2">
int <tt class="descname">rados_create2</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;*pcluster</em>, const char *const<em>&nbsp;clustername</em>, const char *const<em>&nbsp;name</em>, uint64_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_create2" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended version of rados_create.</p>
<p>Like rados_create, but 1) don&#8217;t assume &#8216;client.&#8217;+id; allow full specification of name 2) allow specification of cluster name 3) flags for future expansion</p>
</dd></dl>

<dl class="function">
<dt id="rados_create_with_context">
int <tt class="descname">rados_create_with_context</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;*cluster</em>, <a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a><em>&nbsp;cct</em><big>)</big><a class="headerlink" href="#rados_create_with_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a cluster handle from an existing configuration.</p>
<p>Share configuration state with another rados_t instance.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; where to store the handle</li>
<li><strong>cct_</strong> &#8211; the existing configuration to use</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ping_monitor">
int <tt class="descname">rados_ping_monitor</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*mon_id</em>, char<em>&nbsp;**outstr</em>, size_t<em>&nbsp;*outstrlen</em><big>)</big><a class="headerlink" href="#rados_ping_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Ping the monitor with ID mon_id, storing the resulting reply in buf (if specified) with a maximum size of len.</p>
<p>The result buffer is allocated on the heap; the caller is expected to release that memory with <a class="reference internal" href="#rados_buffer_free" title="rados_buffer_free"><tt class="xref c c-func docutils literal"><span class="pre">rados_buffer_free()</span></tt></a>. The buffer and length pointers can be NULL, in which case they are not filled in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
<li><strong>mon_id</strong> &#8211; ID of the monitor to ping</li>
<li><strong>outstr</strong> &#8211; double pointer with the resulting reply</li>
<li><strong>outstrlen</strong> &#8211; pointer with the size of the reply in outstr</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_connect">
int <tt class="descname">rados_connect</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the cluster.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: Before calling this, calling a function that communicates with the cluster will crash.</p>
</div>
<div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last">The cluster handle is configured with at least a monitor address. If cephx is enabled, a client name and secret must also be set.</p>
</div>
<div class="admonition-postcondition admonition">
<p class="first admonition-title">Postcondition</p>
<p class="last">If this succeeds, any function in librados may be used</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; The cluster to connect to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on sucess, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_shutdown">
void <tt class="descname">rados_shutdown</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnects from the cluster.</p>
<p>For clean up, this is only necessary after <a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has succeeded.</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not guarantee any asynchronous writes have completed. To do that, you must call <a class="reference internal" href="#rados_aio_flush" title="rados_aio_flush"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_flush()</span></tt></a>on all open io contexts.</p>
</div>
<div class="admonition-postcondition admonition">
<p class="first admonition-title">Postcondition</p>
<p class="last">the cluster handle cannot be used again</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cluster</strong> &#8211; the cluster to shutdown</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_read_file">
int <tt class="descname">rados_conf_read_file</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*path</em><big>)</big><a class="headerlink" href="#rados_conf_read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle using a Ceph config file.</p>
<p>If path is NULL, the default locations are searched, and the first found is used. The locations are:<ul class="simple">
<li>$CEPH_CONF (environment variable)</li>
<li>/etc/ceph/ceph.conf</li>
<li>~/.ceph/config</li>
<li>ceph.conf (in the current working directory)</li>
</ul>
</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last"><a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has not been called on the cluster handle</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle to configure</li>
<li><strong>path</strong> &#8211; path to a Ceph configuration file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_argv">
int <tt class="descname">rados_conf_parse_argv</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;argc</em>, const char<em>&nbsp;**argv</em><big>)</big><a class="headerlink" href="#rados_conf_parse_argv" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle with command line arguments.</p>
<p>argv can contain any common Ceph command line option, including any configuration parameter prefixed by &#8216;<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;ndash&#8217;</p>
<pre class="last literal-block">
&lt;ndash xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;/&gt;' and replacing spaces with dashes or underscores. For example, the following options are equivalent:
</pre>
</div>
&#8216; and replacing spaces with dashes or underscores. For example, the following options are equivalent:<ul class="simple">
<li><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;ndash&#8217;</p>
<pre class="last literal-block">
&lt;ndash xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;/&gt;mon-host 10.0.0.1:6789
</pre>
</div>
mon-host 10.0.0.1:6789</li>
<li><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;ndash&#8217;</p>
<pre class="last literal-block">
&lt;ndash xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;/&gt;mon_host 10.0.0.1:6789
</pre>
</div>
mon_host 10.0.0.1:6789</li>
<li>-m 10.0.0.1:6789</li>
</ul>
</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last"><a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has not been called on the cluster handle</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle to configure</li>
<li><strong>argc</strong> &#8211; number of arguments in argv</li>
<li><strong>argv</strong> &#8211; arguments to parse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_argv_remainder">
int <tt class="descname">rados_conf_parse_argv_remainder</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;argc</em>, const char<em>&nbsp;**argv</em>, const char<em>&nbsp;**remargv</em><big>)</big><a class="headerlink" href="#rados_conf_parse_argv_remainder" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle with command line arguments, returning any remainders.</p>
<p>Same rados_conf_parse_argv, except for extra remargv argument to hold returns unrecognized arguments.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last"><a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has not been called on the cluster handle</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle to configure</li>
<li><strong>argc</strong> &#8211; number of arguments in argv</li>
<li><strong>argv</strong> &#8211; arguments to parse</li>
<li><strong>remargv</strong> &#8211; char* array for returned unrecognized arguments</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_env">
int <tt class="descname">rados_conf_parse_env</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*var</em><big>)</big><a class="headerlink" href="#rados_conf_parse_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle based on an environment variable.</p>
<p>The contents of the environment variable are parsed as if they were Ceph command line options. If var is NULL, the CEPH_ARGS environment variable is used.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last"><a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has not been called on the cluster handle</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: this is not threadsafe - it uses a static buffer</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle to configure</li>
<li><strong>var</strong> &#8211; name of the environment variable to read</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_set">
int <tt class="descname">rados_conf_set</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*option</em>, const char<em>&nbsp;*value</em><big>)</big><a class="headerlink" href="#rados_conf_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a configuration option.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last"><a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a>has not been called on the cluster handle</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle to configure</li>
<li><strong>option</strong> &#8211; option to set</li>
<li><strong>value</strong> &#8211; value of the option</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ENOENT when the option is not a Ceph configuration option</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_conf_get">
int <tt class="descname">rados_conf_get</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*option</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_conf_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of a configuration option.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; configuration to read</li>
<li><strong>option</strong> &#8211; which option to read</li>
<li><strong>buf</strong> &#8211; where to write the configuration value</li>
<li><strong>len</strong> &#8211; the size of buf in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ENAMETOOLONG if the buffer is too short to contain the requested value</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_cluster_stat">
int <tt class="descname">rados_cluster_stat</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, struct <a class="reference internal" href="#rados_cluster_stat_t" title="rados_cluster_stat_t">rados_cluster_stat_t</a><em>&nbsp;*result</em><big>)</big><a class="headerlink" href="#rados_cluster_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Read usage info about the cluster.</p>
<p>This tells you total space, space used, space available, and number of objects. These are not updated immediately when data is written, they are eventually consistent.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster to query</li>
<li><strong>result</strong> &#8211; where to store the results</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_cluster_fsid">
int <tt class="descname">rados_cluster_fsid</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_cluster_fsid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fsid of the cluster as a hexadecimal string.</p>
<p>The fsid is a unique id of an entire Ceph cluster.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; where to get the fsid</li>
<li><strong>buf</strong> &#8211; where to write the fsid</li>
<li><strong>len</strong> &#8211; the size of buf in bytes (should be 37)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ERANGE if the buffer is too short to contain the fsid</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_wait_for_latest_osdmap">
int <tt class="descname">rados_wait_for_latest_osdmap</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_wait_for_latest_osdmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get/wait for the most recent osdmap.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster to shutdown</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on sucess, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_list">
int <tt class="descname">rados_pool_list</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_pool_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List pools.</p>
<p>Gets a list of pool names as NULL-terminated strings. The pool names will be placed in the supplied buffer one after another. After the last pool name, there will be two 0 bytes in a row.</p>
<p>If len is too short to fit all the pool name entries we need, we will fill as much as we can.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
<li><strong>buf</strong> &#8211; output buffer</li>
<li><strong>len</strong> &#8211; output buffer length</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">length of the buffer we would need to list all pools</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_cct">
<a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a> <tt class="descname">rados_cct</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_cct" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a configuration handle for a rados cluster handle.</p>
<p>This handle is valid only as long as the cluster handle is valid.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">config handle for this cluster</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_get_instance_id">
uint64_t <tt class="descname">rados_get_instance_id</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_get_instance_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a global id for current instance.</p>
<p>This id is a unique representation of current connection to the cluster</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">instance global id</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_create">
int <tt class="descname">rados_ioctx_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;*ioctx</em><big>)</big><a class="headerlink" href="#rados_ioctx_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an io context.</p>
<p>The io context allows you to perform operations within a particular pool. For more details see rados_ioctx_t.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; which cluster the pool is in</li>
<li><strong>pool_name</strong> &#8211; name of the pool</li>
<li><strong>ioctx</strong> &#8211; where to store the io context</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_destroy">
void <tt class="descname">rados_ioctx_destroy</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>The opposite of rados_ioctx_create.</p>
<p>This just tells librados that you no longer need to use the io context. It may not be freed immediately if there are pending asynchronous requests on it, but you should not use an io context again after calling this function on it.</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not guarantee any asynchronous writes have completed. You must call <a class="reference internal" href="#rados_aio_flush" title="rados_aio_flush"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_flush()</span></tt></a>on the io context before destroying it to do that.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>io</strong> &#8211; the io context to dispose of</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_cct">
<a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a> <tt class="descname">rados_ioctx_cct</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_cct" title="Permalink to this definition">¶</a></dt>
<dd><p>Get configuration hadnle for a pool handle.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; pool handle</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">rados_config_t for this cluster</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_cluster">
<a class="reference internal" href="#rados_t" title="rados_t">rados_t</a> <tt class="descname">rados_ioctx_get_cluster</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cluster handle used by this rados_ioctx_t Note that this is a weak reference, and should not be destroyed via rados_destroy().</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the cluster handle for this io context</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_stat">
int <tt class="descname">rados_ioctx_pool_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, struct <a class="reference internal" href="#rados_pool_stat_t" title="rados_pool_stat_t">rados_pool_stat_t</a><em>&nbsp;*stats</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pool usage statistics.</p>
<p>Fills in a <a class="reference internal" href="#rados_pool_stat_t" title="rados_pool_stat_t"><tt class="xref c c-data docutils literal"><span class="pre">rados_pool_stat_t</span></tt></a>after querying the cluster.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; determines which pool to query</li>
<li><strong>stats</strong> &#8211; where to store the results</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_lookup">
int64_t <tt class="descname">rados_pool_lookup</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the id of a pool.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; which cluster the pool is in</li>
<li><strong>pool_name</strong> &#8211; which pool to look up</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>id of the pool</p>
<p>-ENOENT if the pool is not found</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_reverse_lookup">
int <tt class="descname">rados_pool_reverse_lookup</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;id</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_pool_reverse_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of a pool.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; which cluster the pool is in</li>
<li><strong>id</strong> &#8211; the id of the pool</li>
<li><strong>buf</strong> &#8211; where to store the pool name</li>
<li><strong>maxlen</strong> &#8211; size of buffer where name will be stored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">length of string stored, or -ERANGE if buffer too small</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create">
int <tt class="descname">rados_pool_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with default settings.</p>
<p>The default owner is the admin user (auid 0). The default crush rule is rule 0.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster in which the pool will be created</li>
<li><strong>pool_name</strong> &#8211; the name of the new pool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_auid">
int <tt class="descname">rados_pool_create_with_auid</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em>, uint64_t<em>&nbsp;auid</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool owned by a specific auid.</p>
<p>The auid is the authenticated user id to give ownership of the pool. TODO: document auid and the rest of the auth system</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster in which the pool will be created</li>
<li><strong>pool_name</strong> &#8211; the name of the new pool</li>
<li><strong>auid</strong> &#8211; the id of the owner of the new pool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_crush_rule">
int <tt class="descname">rados_pool_create_with_crush_rule</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em>, uint8_t<em>&nbsp;crush_rule_num</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_crush_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with a specific CRUSH rule.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster in which the pool will be created</li>
<li><strong>pool_name</strong> &#8211; the name of the new pool</li>
<li><strong>crush_rule_num</strong> &#8211; which rule to use for placement in the new pool1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_all">
int <tt class="descname">rados_pool_create_with_all</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em>, uint64_t<em>&nbsp;auid</em>, uint8_t<em>&nbsp;crush_rule_num</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with a specific CRUSH rule and auid.</p>
<p>This is a combination of <a class="reference internal" href="#rados_pool_create_with_crush_rule" title="rados_pool_create_with_crush_rule"><tt class="xref c c-func docutils literal"><span class="pre">rados_pool_create_with_crush_rule()</span></tt></a>and<a class="reference internal" href="#rados_pool_create_with_auid" title="rados_pool_create_with_auid"><tt class="xref c c-func docutils literal"><span class="pre">rados_pool_create_with_auid()</span></tt></a>.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster in which the pool will be created</li>
<li><strong>pool_name</strong> &#8211; the name of the new pool</li>
<li><strong>crush_rule_num</strong> &#8211; which rule to use for placement in the new pool2</li>
<li><strong>auid</strong> &#8211; the id of the owner of the new pool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_get_base_tier">
int <tt class="descname">rados_pool_get_base_tier</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;pool</em>, int64_t<em>&nbsp;*base_tier</em><big>)</big><a class="headerlink" href="#rados_pool_get_base_tier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pool that is the base tier for this pool.</p>
<p>The return value is the ID of the pool that should be used to read from/write to. If tiering is not set up for the pool, returns <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;computeroutput&#8217;</p>
<pre class="last literal-block">
&lt;computeroutput xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;pool&lt;/computeroutput&gt;.
</pre>
</div>
.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster the pool is in</li>
<li><strong>pool</strong> &#8211; ID of the pool to query</li>
<li><strong>base_tier</strong> &#8211; <p>base tier, or <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;computeroutput&#8217;</p>
<pre class="last literal-block">
&lt;computeroutput&gt;pool&lt;/computeroutput&gt; if tiering is not configured
</pre>
</div>
if tiering is not configured</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_pool_delete">
int <tt class="descname">rados_pool_delete</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a pool and all data inside it.</p>
<p>The pool is removed from the cluster immediately, but the actual data is deleted in the background.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; the cluster the pool is in</li>
<li><strong>pool_name</strong> &#8211; which pool to delete</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_set_auid">
int <tt class="descname">rados_ioctx_pool_set_auid</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;auid</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_set_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to change an io context&#8217;s associated auid &#8220;owner.&#8221;.</p>
<p>Requires that you have write permission on both the current and new auid.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; reference to the pool to change.</li>
<li><strong>auid</strong> &#8211; the auid you wish the io to have.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_get_auid">
int <tt class="descname">rados_ioctx_pool_get_auid</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;*auid</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_get_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the auid of a pool.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; pool to query</li>
<li><strong>auid</strong> &#8211; where to store the auid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_requires_alignment">
int <tt class="descname">rados_ioctx_pool_requires_alignment</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_requires_alignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_required_alignment">
uint64_t <tt class="descname">rados_ioctx_pool_required_alignment</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_required_alignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_id">
int64_t <tt class="descname">rados_ioctx_get_id</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pool id of the io context.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context to query</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the id of the pool the io context uses</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_pool_name">
int <tt class="descname">rados_ioctx_get_pool_name</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, char<em>&nbsp;*buf</em>, unsigned<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_pool_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pool name of the io context.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context to query</li>
<li><strong>buf</strong> &#8211; pointer to buffer where name will be stored</li>
<li><strong>maxlen</strong> &#8211; size of buffer where name will be stored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">length of string stored, or -ERANGE if buffer too small</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_locator_set_key">
void <tt class="descname">rados_ioctx_locator_set_key</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*key</em><big>)</big><a class="headerlink" href="#rados_ioctx_locator_set_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the key for mapping objects to pgs within an io context.</p>
<p>The key is used instead of the object name to determine which placement groups an object is put in. This affects all subsequent operations of the io context - until a different locator key is set, all objects in this io context will be placed in the same pg.</p>
<p>This is useful if you need to do clone_range operations, which must be done with the source and destination objects in the same pg.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>io</strong> &#8211; the io context to change</li>
<li><strong>key</strong> &#8211; the key to use as the object locator, or NULL to discard any previously set key</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_set_namespace">
void <tt class="descname">rados_ioctx_set_namespace</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*nspace</em><big>)</big><a class="headerlink" href="#rados_ioctx_set_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the namespace for objects within an io context.</p>
<p>The namespace specification further refines a pool into different domains. The mapping of objects to pgs is also based on this value.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>io</strong> &#8211; the io context to change</li>
<li><strong>nspace</strong> &#8211; the name to use as the namespace, or NULL use the default namespace</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_open">
int <tt class="descname">rados_nobjects_list_open</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;*ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_open" title="Permalink to this definition">¶</a></dt>
<dd><p>Start listing objects in a pool.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to list from</li>
<li><strong>ctx</strong> &#8211; the handle to store list context in</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_get_pg_hash_position">
uint32_t <tt class="descname">rados_nobjects_list_get_pg_hash_position</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_get_pg_hash_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Return hash position of iterator, rounded to the current <tt class="xref c c-data docutils literal"><span class="pre">PG</span></tt>.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ctx</strong> &#8211; iterator marking where you are in the listing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">current hash position, rounded to the current pg</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_seek">
uint32_t <tt class="descname">rados_nobjects_list_seek</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, uint32_t<em>&nbsp;pos</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_seek" title="Permalink to this definition">¶</a></dt>
<dd><p>Reposition object iterator to a different hash position.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ctx</strong> &#8211; iterator marking where you are in the listing</li>
<li><strong>pos</strong> &#8211; hash position to move to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">actual (rounded) position we moved to</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_next">
int <tt class="descname">rados_nobjects_list_next</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, const char<em>&nbsp;**entry</em>, const char<em>&nbsp;**key</em>, const char<em>&nbsp;**nspace</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next object name and locator in the pool.</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;entry and *key are valid until next call to rados_objects_list_&lt;/emphasis&gt;
</pre>
</div>
</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ctx</strong> &#8211; iterator marking where you are in the listing</li>
<li><strong>entry</strong> &#8211; where to store the name of the entry</li>
<li><strong>key</strong> &#8211; where to store the object locator (set to NULL to ignore)</li>
<li><strong>nspace</strong> &#8211; where to store the object namespace (set to NULL to ignore)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ENOENT when there are no more objects to list</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_close">
void <tt class="descname">rados_nobjects_list_close</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the object listing handle.</p>
<p>This should be called when the handle is no longer needed. The handle should not be used after it has been closed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ctx</strong> &#8211; the handle to close</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_open">
int <tt class="descname">rados_objects_list_open</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;*ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_open" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_nobjects_list_open" title="rados_nobjects_list_open"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_open()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_get_pg_hash_position">
uint32_t <tt class="descname">rados_objects_list_get_pg_hash_position</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_get_pg_hash_position" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_nobjects_list_get_pg_hash_position" title="rados_nobjects_list_get_pg_hash_position"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_get_pg_hash_position()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_seek">
uint32_t <tt class="descname">rados_objects_list_seek</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, uint32_t<em>&nbsp;pos</em><big>)</big><a class="headerlink" href="#rados_objects_list_seek" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_nobjects_list_seek" title="rados_nobjects_list_seek"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_seek()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_next">
int <tt class="descname">rados_objects_list_next</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, const char<em>&nbsp;**entry</em>, const char<em>&nbsp;**key</em><big>)</big><a class="headerlink" href="#rados_objects_list_next" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_nobjects_list_next" title="rados_nobjects_list_next"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_next()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_close">
void <tt class="descname">rados_objects_list_close</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_close" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_nobjects_list_close" title="rados_nobjects_list_close"><tt class="xref c c-func docutils literal"><span class="pre">rados_nobjects_list_close()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_create">
int <tt class="descname">rados_ioctx_snap_create</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool-wide snapshot.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to snapshot</li>
<li><strong>snapname</strong> &#8211; the name of the snapshot</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_remove">
int <tt class="descname">rados_ioctx_snap_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a pool snapshot.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to delete the snapshot from</li>
<li><strong>snapname</strong> &#8211; which snapshot to delete</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_rollback">
int <tt class="descname">rados_ioctx_snap_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback an object to a pool snapshot.</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool in which the object is stored</li>
<li><strong>oid</strong> &#8211; the name of the object to rollback</li>
<li><strong>snapname</strong> &#8211; which snapshot to rollback to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_rollback">
int <tt class="descname">rados_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*snapname</em><big>)</big><a class="headerlink" href="#rados_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Deprecated: Use <a class="reference internal" href="#rados_ioctx_snap_rollback" title="rados_ioctx_snap_rollback"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_snap_rollback()</span></tt></a>instead</p>
</div>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_set_read">
void <tt class="descname">rados_ioctx_snap_set_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snap</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_set_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot from which reads are performed.</p>
<p>Subsequent reads will return data as it was at the time of that snapshot.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>io</strong> &#8211; the io context to change</li>
<li><strong>snap</strong> &#8211; the id of the snapshot to set, or LIBRADOS_SNAP_HEAD for no snapshot (i.e. normal operation)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_create">
int <tt class="descname">rados_ioctx_selfmanaged_snap_create</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;*snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate an ID for a self-managed snapshot.</p>
<p>Get a unique ID to put in the snaphot context to create a snapshot. A clone of an object is not created until a write with the new snapshot context is completed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool in which the snapshot will exist</li>
<li><strong>snapid</strong> &#8211; where to store the newly allocated snapshot ID</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_remove">
int <tt class="descname">rados_ioctx_selfmanaged_snap_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a self-managed snapshot.</p>
<p>This increases the snapshot sequence number, which will cause snapshots to be removed lazily.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool in which the snapshot will exist</li>
<li><strong>snapid</strong> &#8211; where to store the newly allocated snapshot ID</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_rollback">
int <tt class="descname">rados_ioctx_selfmanaged_snap_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback an object to a self-managed snapshot.</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool in which the object is stored</li>
<li><strong>oid</strong> &#8211; the name of the object to rollback</li>
<li><strong>snapid</strong> &#8211; which snapshot to rollback to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_set_write_ctx">
int <tt class="descname">rados_ioctx_selfmanaged_snap_set_write_ctx</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;seq</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;*snaps</em>, int<em>&nbsp;num_snaps</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_set_write_ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot context for use when writing to objects.</p>
<p>This is stored in the io context, and applies to all future writes.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context to change</li>
<li><strong>seq</strong> &#8211; the newest snapshot sequence number for the pool</li>
<li><strong>snaps</strong> &#8211; array of snapshots in sorted by descending id</li>
<li><strong>num_snaps</strong> &#8211; how many snaphosts are in the snaps array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-EINVAL if snaps are not in descending order</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_list">
int <tt class="descname">rados_ioctx_snap_list</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;*snaps</em>, int<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List all the ids of pool snapshots.</p>
<p>If the output array does not have enough space to fit all the snapshots, -ERANGE is returned and the caller should retry with a larger array.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to read from</li>
<li><strong>snaps</strong> &#8211; where to store the results</li>
<li><strong>maxlen</strong> &#8211; the number of rados_snap_t that fit in the snaps array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>number of snapshots on success, negative error code on failure</p>
<p>-ERANGE is returned if the snaps array is too short</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_lookup">
int <tt class="descname">rados_ioctx_snap_lookup</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*name</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;*id</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the id of a pool snapshot.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to read from</li>
<li><strong>name</strong> &#8211; the snapshot to find</li>
<li><strong>id</strong> &#8211; where to store the result</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_get_name">
int <tt class="descname">rados_ioctx_snap_get_name</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;id</em>, char<em>&nbsp;*name</em>, int<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of a pool snapshot.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to read from</li>
<li><strong>id</strong> &#8211; the snapshot to find</li>
<li><strong>name</strong> &#8211; where to store the result</li>
<li><strong>maxlen</strong> &#8211; the size of the name array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ERANGE if the name array is too small</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_get_stamp">
int <tt class="descname">rados_ioctx_snap_get_stamp</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;id</em>, time_t<em>&nbsp;*t</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_get_stamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Find when a pool snapshot occurred.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool the snapshot was taken in</li>
<li><strong>id</strong> &#8211; the snapshot to lookup</li>
<li><strong>t</strong> &#8211; where to store the result</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_get_last_version">
uint64_t <tt class="descname">rados_get_last_version</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_get_last_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the version of the last object read or written to.</p>
<p>This exposes the internal version number of the last object read or written via this io context</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context to check</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">last read or written object version</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write">
int <tt class="descname">rados_write</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; bytes from
</pre>
</div>
bytes from<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;buf&lt;/emphasis&gt; into the
</pre>
</div>
into the<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;oid&lt;/emphasis&gt; object, starting at offset
</pre>
</div>
object, starting at offset<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;off&lt;/emphasis&gt;.
</pre>
</div>
.</p>
<p>The value of <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; must be &amp;lt;= UINT_MAX/2.
</pre>
</div>
must be &lt;= UINT_MAX/2.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This will never return a positive value not equal to len.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context in which the write will occur</li>
<li><strong>oid</strong> &#8211; name of the object</li>
<li><strong>buf</strong> &#8211; data to write</li>
<li><strong>len</strong> &#8211; length of the data, in bytes</li>
<li><strong>off</strong> &#8211; byte offset in the object to begin writing at</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_full">
int <tt class="descname">rados_write_full</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; bytes from
</pre>
</div>
bytes from<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;buf&lt;/emphasis&gt; into the
</pre>
</div>
into the<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;oid&lt;/emphasis&gt; object.
</pre>
</div>
object.</p>
<p>The value of <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; must be &amp;lt;= UINT_MAX/2.
</pre>
</div>
must be &lt;= UINT_MAX/2.</p>
<p>The object is filled with the provided data. If the object exists, it is atomically truncated and then written.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context in which the write will occur</li>
<li><strong>oid</strong> &#8211; name of the object</li>
<li><strong>buf</strong> &#8211; data to write</li>
<li><strong>len</strong> &#8211; length of the data, in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_clone_range">
int <tt class="descname">rados_clone_range</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*dst</em>, uint64_t<em>&nbsp;dst_off</em>, const char<em>&nbsp;*src</em>, uint64_t<em>&nbsp;src_off</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_clone_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently copy a portion of one object to another.</p>
<p>If the underlying filesystem on the <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>supports it, this will be a copy-on-write clone.</p>
<p>The src and dest objects must be in the same pg. To ensure this, the io context should have a locator key set (see <a class="reference internal" href="#rados_ioctx_locator_set_key" title="rados_ioctx_locator_set_key"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_locator_set_key()</span></tt></a>).</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which the data is cloned</li>
<li><strong>dst</strong> &#8211; the name of the destination object</li>
<li><strong>dst_off</strong> &#8211; the offset within the destination object (in bytes)</li>
<li><strong>src</strong> &#8211; the name of the source object</li>
<li><strong>src_off</strong> &#8211; the offset within the source object (in bytes)</li>
<li><strong>len</strong> &#8211; how much data to copy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_append">
int <tt class="descname">rados_append</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; bytes from
</pre>
</div>
bytes from<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;buf&lt;/emphasis&gt; into the
</pre>
</div>
into the<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;oid&lt;/emphasis&gt; object.
</pre>
</div>
object.</p>
<p>The value of <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>asphyxiate: No renderer found for doxygen tag &#8216;emphasis&#8217;</p>
<pre class="last literal-block">
&lt;emphasis xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;len&lt;/emphasis&gt; must be &amp;lt;= UINT_MAX/2.
</pre>
</div>
must be &lt;= UINT_MAX/2.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>oid</strong> &#8211; the name of the object</li>
<li><strong>buf</strong> &#8211; the data to append</li>
<li><strong>len</strong> &#8211; length of buf (in bytes)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read">
int <tt class="descname">rados_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from an object.</p>
<p>The io context determines the snapshot to read from, if any was set by <a class="reference internal" href="#rados_ioctx_snap_set_read" title="rados_ioctx_snap_set_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_snap_set_read()</span></tt></a>.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to perform the read</li>
<li><strong>oid</strong> &#8211; the name of the object to read from</li>
<li><strong>buf</strong> &#8211; where to store the results</li>
<li><strong>len</strong> &#8211; the number of bytes to read</li>
<li><strong>off</strong> &#8211; the offset to start reading from in the object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">number of bytes read on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_remove">
int <tt class="descname">rados_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em><big>)</big><a class="headerlink" href="#rados_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an object.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This does not delete any snapshots of the object.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool to delete the object from</li>
<li><strong>oid</strong> &#8211; the name of the object to delete</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_trunc">
int <tt class="descname">rados_trunc</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, uint64_t<em>&nbsp;size</em><big>)</big><a class="headerlink" href="#rados_trunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an object.</p>
<p>If this enlarges the object, the new area is logically filled with zeroes. If this shrinks the object, the excess data is removed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to truncate</li>
<li><strong>oid</strong> &#8211; the name of the object</li>
<li><strong>size</strong> &#8211; the new size of the object in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_getxattr">
int <tt class="descname">rados_getxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_getxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of an extended attribute on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which the attribute is read</li>
<li><strong>o</strong> &#8211; name of the object</li>
<li><strong>name</strong> &#8211; which extended attribute to read</li>
<li><strong>buf</strong> &#8211; where to store the result</li>
<li><strong>len</strong> &#8211; size of buf in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">length of xattr value on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_setxattr">
int <tt class="descname">rados_setxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_setxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an extended attribute on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which xattr is set</li>
<li><strong>o</strong> &#8211; name of the object</li>
<li><strong>name</strong> &#8211; which extended attribute to set</li>
<li><strong>buf</strong> &#8211; what to store in the xattr</li>
<li><strong>len</strong> &#8211; the number of bytes in buf</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_rmxattr">
int <tt class="descname">rados_rmxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em><big>)</big><a class="headerlink" href="#rados_rmxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an extended attribute from an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to delete the xattr</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; which xattr to delete</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs">
int <tt class="descname">rados_getxattrs</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;*iter</em><big>)</big><a class="headerlink" href="#rados_getxattrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over xattrs on an object.</p>
<p><div class="admonition-postcondition admonition">
<p class="first admonition-title">Postcondition</p>
<p class="last">iter is a valid iterator</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to list xattrs</li>
<li><strong>oid</strong> &#8211; name of the object</li>
<li><strong>iter</strong> &#8211; where to store the iterator</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs_next">
int <tt class="descname">rados_getxattrs_next</tt><big>(</big><a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;iter</em>, const char<em>&nbsp;**name</em>, const char<em>&nbsp;**val</em>, size_t<em>&nbsp;*len</em><big>)</big><a class="headerlink" href="#rados_getxattrs_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next xattr on the object.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last">iter is a valid iterator</p>
</div>
<div class="admonition-postcondition admonition">
<p class="first admonition-title">Postcondition</p>
<p class="last">name is the NULL-terminated name of the next xattr, and val contains the value of the xattr, which is of length len. If the end of the list has been reached, name and val are NULL, and len is 0.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iter</strong> &#8211; iterator to advance</li>
<li><strong>name</strong> &#8211; where to store the name of the next xattr</li>
<li><strong>val</strong> &#8211; where to store the value of the next xattr</li>
<li><strong>len</strong> &#8211; the number of bytes in val</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs_end">
void <tt class="descname">rados_getxattrs_end</tt><big>(</big><a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_getxattrs_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the xattr iterator.</p>
<p>iter should not be used after this is called.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> &#8211; the iterator to close</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_omap_get_next">
int <tt class="descname">rados_omap_get_next</tt><big>(</big><a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;iter</em>, char<em>&nbsp;**key</em>, char<em>&nbsp;**val</em>, size_t<em>&nbsp;*len</em><big>)</big><a class="headerlink" href="#rados_omap_get_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next omap key/value pair on the object.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last">iter is a valid iterator</p>
</div>
<div class="admonition-postcondition admonition">
<p class="first admonition-title">Postcondition</p>
<p class="last">key and val are the next key/value pair. key is null-terminated, and val has length len. If the end of the list has been reached, key and val are NULL, and len is 0. key and val will not be accessible after <a class="reference internal" href="#rados_omap_get_end" title="rados_omap_get_end"><tt class="xref c c-func docutils literal"><span class="pre">rados_omap_get_end()</span></tt></a>is called on iter, so if they are needed after that they should be copied.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iter</strong> &#8211; iterator to advance</li>
<li><strong>key</strong> &#8211; where to store the key of the next omap entry</li>
<li><strong>val</strong> &#8211; where to store the value of the next omap entry</li>
<li><strong>len</strong> &#8211; where to store the number of bytes in val</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_omap_get_end">
void <tt class="descname">rados_omap_get_end</tt><big>(</big><a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_omap_get_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the omap iterator.</p>
<p>iter should not be used after this is called.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iter</strong> &#8211; the iterator to close</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_stat">
int <tt class="descname">rados_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, uint64_t<em>&nbsp;*psize</em>, time_t<em>&nbsp;*pmtime</em><big>)</big><a class="headerlink" href="#rados_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get object stats (size/mtime)</p>
<p>TODO: when are these set, and by whom? can they be out of date?</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>o</strong> &#8211; object name</li>
<li><strong>psize</strong> &#8211; where to store object size</li>
<li><strong>pmtime</strong> &#8211; where to store modification time</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_update">
int <tt class="descname">rados_tmap_update</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*cmdbuf</em>, size_t<em>&nbsp;cmdbuflen</em><big>)</big><a class="headerlink" href="#rados_tmap_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update tmap (trivial map)</p>
<p>Do compound update to a tmap object, inserting or deleting some number of records. cmdbuf is a series of operation byte codes, following by command payload. Each command is a single-byte command code, whose value is one of CEPH_OSD_TMAP_*.</p>
<p><ul class="simple">
<li>update tmap &#8216;header&#8217;<ul>
<li>1 byte = CEPH_OSD_TMAP_HDR</li>
<li>4 bytes = data length (little endian)</li>
<li>N bytes = data</li>
</ul>
</li>
<li>insert/update one key/value pair<ul>
<li>1 byte = CEPH_OSD_TMAP_SET</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
<li>4 bytes = data length (little endian)</li>
<li>M bytes = data</li>
</ul>
</li>
<li>insert one key/value pair; return -EEXIST if it already exists.<ul>
<li>1 byte = CEPH_OSD_TMAP_CREATE</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
<li>4 bytes = data length (little endian)</li>
<li>M bytes = data</li>
</ul>
</li>
<li>remove one key/value pair<ul>
<li>1 byte = CEPH_OSD_TMAP_RM</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
</ul>
</li>
</ul>
</p>
<p>Restrictions:<ul class="simple">
<li>The HDR update must preceed any key/value updates.</li>
<li>All key/value updates must be in lexicographically sorted order in cmdbuf.</li>
<li>You can read/write to a tmap object via the regular APIs, but you should be careful not to corrupt it. Also be aware that the object format may change without notice.</li>
</ul>
</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>o</strong> &#8211; object name</li>
<li><strong>cmdbuf</strong> &#8211; command buffer</li>
<li><strong>cmdbuflen</strong> &#8211; command buffer length in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_put">
int <tt class="descname">rados_tmap_put</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;buflen</em><big>)</big><a class="headerlink" href="#rados_tmap_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Store complete tmap (trivial map) object.</p>
<p>Put a full tmap object into the store, replacing what was there.</p>
<p>The format of buf is:<ul class="simple">
<li>4 bytes - length of header (little endian)</li>
<li>N bytes - header data</li>
<li>4 bytes - number of keys (little endian)</li>
</ul>
</p>
<p>and for each key,<ul class="simple">
<li>4 bytes - key name length (little endian)</li>
<li>N bytes - key name</li>
<li>4 bytes - value length (little endian)</li>
<li>M bytes - value data</li>
</ul>
</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>o</strong> &#8211; object name</li>
<li><strong>buf</strong> &#8211; buffer</li>
<li><strong>buflen</strong> &#8211; buffer length in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_get">
int <tt class="descname">rados_tmap_get</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;buflen</em><big>)</big><a class="headerlink" href="#rados_tmap_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch complete tmap (trivial map) object.</p>
<p>Read a full tmap object. See <a class="reference internal" href="#rados_tmap_put" title="rados_tmap_put"><tt class="xref c c-func docutils literal"><span class="pre">rados_tmap_put()</span></tt></a>for the format the data is returned in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>o</strong> &#8211; object name</li>
<li><strong>buf</strong> &#8211; buffer</li>
<li><strong>buflen</strong> &#8211; buffer length in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ERANGE if buf isn&#8217;t big enough</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_exec">
int <tt class="descname">rados_exec</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, const char<em>&nbsp;*cls</em>, const char<em>&nbsp;*method</em>, const char<em>&nbsp;*in_buf</em>, size_t<em>&nbsp;in_len</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;out_len</em><big>)</big><a class="headerlink" href="#rados_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>class method on an object.</p>
<p>The <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>has a plugin mechanism for performing complicated operations on an object atomically. These plugins are called classes. This function allows librados users to call the custom methods. The input and output formats are defined by the class. Classes in ceph.git can be found in src/cls subdirectories</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to call the method</li>
<li><strong>oid</strong> &#8211; the object to call the method on</li>
<li><strong>cls</strong> &#8211; the name of the class</li>
<li><strong>method</strong> &#8211; the name of the method</li>
<li><strong>in_buf</strong> &#8211; where to find input</li>
<li><strong>in_len</strong> &#8211; length of in_buf in bytes</li>
<li><strong>buf</strong> &#8211; where to store output</li>
<li><strong>out_len</strong> &#8211; length of buf in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the length of the output, or -ERANGE if out_buf does not have enough space to store it (For methods that return data). For methods that don&#8217;t return data, the return value is method-specific.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_create_completion">
int <tt class="descname">rados_aio_create_completion</tt><big>(</big>void<em>&nbsp;*cb_arg</em>, <a class="reference internal" href="#rados_callback_t" title="rados_callback_t">rados_callback_t</a><em>&nbsp;cb_complete</em>, <a class="reference internal" href="#rados_callback_t" title="rados_callback_t">rados_callback_t</a><em>&nbsp;cb_safe</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;*pc</em><big>)</big><a class="headerlink" href="#rados_aio_create_completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a completion to use with asynchronous operations.</p>
<p>The complete and safe callbacks correspond to operations being acked and committed, respectively. The callbacks are called in order of receipt, so the safe callback may be triggered before the complete callback, and vice versa. This is affected by journalling on the OSDs.</p>
<p>TODO: more complete documentation of this elsewhere (in the RADOS docs?)</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Read operations only get a complete callback.</p>
<p class="last">BUG: this should check for ENOMEM instead of throwing an exception</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cb_arg</strong> &#8211; application-defined data passed to the callback functions</li>
<li><strong>cb_complete</strong> &#8211; the function to be called when the operation is in memory on all relpicas</li>
<li><strong>cb_safe</strong> &#8211; the function to be called when the operation is on stable storage on all replicas</li>
<li><strong>pc</strong> &#8211; where to store the completion</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_complete">
int <tt class="descname">rados_aio_wait_for_complete</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation completes.</p>
<p>This means it is in memory on all replicas.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: this should be void</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; operation to wait for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_safe">
int <tt class="descname">rados_aio_wait_for_safe</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation is safe.</p>
<p>This means it is on stable storage on all replicas.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: this should be void</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; operation to wait for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_complete">
int <tt class="descname">rados_aio_is_complete</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Has an asynchronous operation completed?</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not imply that the complete callback has finished</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; async operation to inspect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">whether c is complete</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_safe">
int <tt class="descname">rados_aio_is_safe</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Is an asynchronous operation safe?</p>
<p><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not imply that the safe callback has finished</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; async operation to inspect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">whether c is safe</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_complete_and_cb">
int <tt class="descname">rados_aio_wait_for_complete_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_complete_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation completes and callback completes.</p>
<p>This means it is in memory on all replicas and can be read.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: this should be void</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; operation to wait for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_safe_and_cb">
int <tt class="descname">rados_aio_wait_for_safe_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_safe_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation is safe and callback has completed.</p>
<p>This means it is on stable storage on all replicas.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: this should be void</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; operation to wait for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_complete_and_cb">
int <tt class="descname">rados_aio_is_complete_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_complete_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Has an asynchronous operation and callback completed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; async operation to inspect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">whether c is complete</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_safe_and_cb">
int <tt class="descname">rados_aio_is_safe_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_safe_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Is an asynchronous operation safe and has the callback completed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; async operation to inspect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">whether c is safe</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_get_return_value">
int <tt class="descname">rados_aio_get_return_value</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_get_return_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the return value of an asychronous operation.</p>
<p>The return value is set when the operation is complete or safe, whichever comes first.</p>
<p><div class="admonition-precondition admonition">
<p class="first admonition-title">Precondition</p>
<p class="last">The operation is safe or complete</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: complete callback may never be called when the safe message is received before the complete message</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> &#8211; async operation to inspect</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">return value of the operation</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_release">
void <tt class="descname">rados_aio_release</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a completion.</p>
<p>Call this when you no longer need the completion. It may not be freed immediately if the operation is not acked and committed.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c</strong> &#8211; completion to release</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write">
int <tt class="descname">rados_aio_write</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to an object asynchronously.</p>
<p>Queues the write and returns. The return value of the completion will be 0 on success, negative error code on failure.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which the write will occur</li>
<li><strong>oid</strong> &#8211; name of the object</li>
<li><strong>completion</strong> &#8211; what to do when the write is safe and complete</li>
<li><strong>buf</strong> &#8211; data to write</li>
<li><strong>len</strong> &#8211; length of the data, in bytes</li>
<li><strong>off</strong> &#8211; byte offset in the object to begin writing at</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_append">
int <tt class="descname">rados_aio_append</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously append data to an object.</p>
<p>Queues the append and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>oid</strong> &#8211; the name of the object</li>
<li><strong>completion</strong> &#8211; what to do when the append is safe and complete</li>
<li><strong>buf</strong> &#8211; the data to append</li>
<li><strong>len</strong> &#8211; length of buf (in bytes)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write_full">
int <tt class="descname">rados_aio_write_full</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously write an entire object.</p>
<p>The object is filled with the provided data. If the object exists, it is atomically truncated and then written. Queues the write_full and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the io context in which the write will occur</li>
<li><strong>oid</strong> &#8211; name of the object</li>
<li><strong>completion</strong> &#8211; what to do when the write_full is safe and complete</li>
<li><strong>buf</strong> &#8211; data to write</li>
<li><strong>len</strong> &#8211; length of the data, in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_remove">
int <tt class="descname">rados_aio_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously remove an object.</p>
<p>Queues the remove and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>oid</strong> &#8211; the name of the object</li>
<li><strong>completion</strong> &#8211; what to do when the remove is safe and complete</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_read">
int <tt class="descname">rados_aio_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously read data from an object.</p>
<p>The io context determines the snapshot to read from, if any was set by <a class="reference internal" href="#rados_ioctx_snap_set_read" title="rados_ioctx_snap_set_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_snap_set_read()</span></tt></a>.</p>
<p>The return value of the completion will be number of bytes read on success, negative error code on failure.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">only the &#8216;complete&#8217; callback of the completion will be called.</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context in which to perform the read</li>
<li><strong>oid</strong> &#8211; the name of the object to read from</li>
<li><strong>completion</strong> &#8211; what to do when the read is complete</li>
<li><strong>buf</strong> &#8211; where to store the results</li>
<li><strong>len</strong> &#8211; the number of bytes to read</li>
<li><strong>off</strong> &#8211; the offset to start reading from in the object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_flush">
int <tt class="descname">rados_aio_flush</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_aio_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all pending writes in an io context are safe.</p>
<p>This is not equivalent to calling <a class="reference internal" href="#rados_aio_wait_for_safe" title="rados_aio_wait_for_safe"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_wait_for_safe()</span></tt></a>on all write completions, since this waits for the associated callbacks to complete as well.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BUG: always returns 0, should be void or accept a timeout</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to flush</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_flush_async">
int <tt class="descname">rados_aio_flush_async</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_flush_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedule a callback for when all currently pending aio writes are safe.</p>
<p>This is a non-blocking version of <a class="reference internal" href="#rados_aio_flush" title="rados_aio_flush"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_flush()</span></tt></a>.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to flush</li>
<li><strong>completion</strong> &#8211; what to do when the writes are safe</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_stat">
int <tt class="descname">rados_aio_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, uint64_t<em>&nbsp;*psize</em>, time_t<em>&nbsp;*pmtime</em><big>)</big><a class="headerlink" href="#rados_aio_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously get object stats (size/mtime)</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>o</strong> &#8211; object name</li>
<li><strong>psize</strong> &#8211; where to store object size</li>
<li><strong>pmtime</strong> &#8211; where to store modification time</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_cancel">
int <tt class="descname">rados_aio_cancel</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel async operation.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; ioctx</li>
<li><strong>completion</strong> &#8211; completion handle</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_watch">
int <tt class="descname">rados_watch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, uint64_t<em>&nbsp;ver</em>, uint64_t<em>&nbsp;*handle</em>, <a class="reference internal" href="#rados_watchcb_t" title="rados_watchcb_t">rados_watchcb_t</a><em>&nbsp;watchcb</em>, void<em>&nbsp;*arg</em><big>)</big><a class="headerlink" href="#rados_watch" title="Permalink to this definition">¶</a></dt>
<dd><p>Register an interest in an object.</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. If the client loses its connection to the primary <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>for a watched object, the watch will be removed after 30 seconds. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>BUG: watch timeout should be configurable</p>
<p>BUG: librados should provide a way for watchers to notice connection resets</p>
<p class="last">BUG: the ver parameter does not work, and -ERANGE will never be returned (See URL tracker.ceph.com/issues/2592)</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool the object is in</li>
<li><strong>o</strong> &#8211; the object to watch</li>
<li><strong>ver</strong> &#8211; expected version of the object</li>
<li><strong>handle</strong> &#8211; where to store the internal id assigned to this watch</li>
<li><strong>watchcb</strong> &#8211; what to do when a notify is received on this object</li>
<li><strong>arg</strong> &#8211; application defined data to pass when watchcb is called</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ERANGE if the version of the object is greater than ver</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_unwatch">
int <tt class="descname">rados_unwatch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, uint64_t<em>&nbsp;handle</em><big>)</big><a class="headerlink" href="#rados_unwatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Unregister an interest in an object.</p>
<p>Once this completes, no more notifies will be sent to us for this watch. This should be called to clean up unneeded watchers.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool the object is in</li>
<li><strong>o</strong> &#8211; the name of the watched object</li>
<li><strong>handle</strong> &#8211; which watch to unregister</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_notify">
int <tt class="descname">rados_notify</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, uint64_t<em>&nbsp;ver</em>, const char<em>&nbsp;*buf</em>, int<em>&nbsp;buf_len</em><big>)</big><a class="headerlink" href="#rados_notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Sychronously notify watchers of an object.</p>
<p>This blocks until all watchers of the object have received and reacted to the notify, or a timeout is reached.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>BUG: the timeout is not changeable via the C API</p>
<p class="last">BUG: the bufferlist is inaccessible in a rados_watchcb_t</p>
</div>
</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool the object is in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>ver</strong> &#8211; obsolete - just pass zero</li>
<li><strong>buf</strong> &#8211; data to send to watchers</li>
<li><strong>buf_len</strong> &#8211; length of buf in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_set_alloc_hint">
int <tt class="descname">rados_set_alloc_hint</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em><big>)</big><a class="headerlink" href="#rados_set_alloc_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object.</p>
<p>This is an advisory operation, it will always succeed (as if it was submitted with a LIBRADOS_OP_FLAG_FAILOK flag set) and is not guaranteed to do anything on the backend.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the pool the object is in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>expected_object_size</strong> &#8211; expected size of the object, in bytes</li>
<li><strong>expected_write_size</strong> &#8211; expected size of writes to the object, in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_create_write_op">
<a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a> <tt class="descname">rados_create_write_op</tt><big>(</big>void<big>)</big><a class="headerlink" href="#rados_create_write_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new rados_write_op_t write operation.</p>
<p>This will store all actions to be performed atomically. You must call rados_release_write_op when you are finished with it.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">non-NULL on success, NULL on memory allocation error.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_release_write_op">
void <tt class="descname">rados_release_write_op</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_release_write_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a rados_write_op_t, must be called when you&#8217;re done with it.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to deallocate, created with rados_create_write_op</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_set_flags">
void <tt class="descname">rados_write_op_set_flags</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_set_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Set flags for the last operation added to this write_op.</p>
<p>At least one op must have been added to the write_op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flags</strong> &#8211; see librados.h constants beginning with LIBRADOS_OP_FLAG</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_assert_exists">
void <tt class="descname">rados_write_op_assert_exists</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_assert_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists before writing.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_cmpxattr">
void <tt class="descname">rados_write_op_cmpxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*name</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char<em>&nbsp;*value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_write_op_cmpxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that given xattr satisfies comparison.</p>
<p>If the comparison is not satisfied, the return code of the operation will be -ECANCELED</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>name</strong> &#8211; name of the xattr to look up</li>
<li><strong>comparison_operator</strong> &#8211; currently undocumented, look for LIBRADOS_CMPXATTR_OP_EQ in librados.h</li>
<li><strong>value</strong> &#8211; buffer to compare actual xattr value to</li>
<li><strong>value_len</strong> &#8211; length of buffer to compare actual xattr value to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_cmp">
void <tt class="descname">rados_write_op_omap_cmp</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*key</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char<em>&nbsp;*val</em>, size_t<em>&nbsp;val_len</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an omap value satisfies a comparison, with the supplied value on the right hand side (i.e.</p>
<p>for OP_LT, the comparison is actual_value &lt; value.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>key</strong> &#8211; which omap value to compare</li>
<li><strong>comparison_operator</strong> &#8211; one of LIBRADOS_CMPXATTR_OP_EQ, LIBRADOS_CMPXATTR_OP_LT, or LIBRADOS_CMPXATTR_OP_GT</li>
<li><strong>val</strong> &#8211; value to compare with</li>
<li><strong>val_len</strong> &#8211; length of value in bytes</li>
<li><strong>prval</strong> &#8211; where to store the return value from this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_setxattr">
void <tt class="descname">rados_write_op_setxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_write_op_setxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an xattr.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>name</strong> &#8211; name of the xattr</li>
<li><strong>value</strong> &#8211; buffer to set xattr to</li>
<li><strong>value_len</strong> &#8211; length of buffer to set xattr to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_rmxattr">
void <tt class="descname">rados_write_op_rmxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*name</em><big>)</big><a class="headerlink" href="#rados_write_op_rmxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an xattr.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>name</strong> &#8211; name of the xattr to remove</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_create">
void <tt class="descname">rados_write_op_create</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, int<em>&nbsp;exclusive</em>, const char<em>&nbsp;*category</em><big>)</big><a class="headerlink" href="#rados_write_op_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>exclusive</strong> &#8211; set to either LIBRADOS_CREATE_EXCLUSIVE or LIBRADOS_CREATE_IDEMPOTENT will error if the object already exists.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_write">
void <tt class="descname">rados_write_op_write</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*buffer</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;offset</em><big>)</big><a class="headerlink" href="#rados_write_op_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to offset.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>offset</strong> &#8211; offset to write to</li>
<li><strong>buffer</strong> &#8211; bytes to write</li>
<li><strong>len</strong> &#8211; length of buffer</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_write_full">
void <tt class="descname">rados_write_op_write_full</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*buffer</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Write whole object, atomically replacing it.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>buffer</strong> &#8211; bytes to write</li>
<li><strong>len</strong> &#8211; length of buffer</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_append">
void <tt class="descname">rados_write_op_append</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*buffer</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append to end of object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>buffer</strong> &#8211; bytes to write</li>
<li><strong>len</strong> &#8211; length of buffer</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_remove">
void <tt class="descname">rados_write_op_remove</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_truncate">
void <tt class="descname">rados_write_op_truncate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;offset</em><big>)</big><a class="headerlink" href="#rados_write_op_truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to  Offset to truncate to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_zero">
void <tt class="descname">rados_write_op_zero</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;offset</em>, uint64_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero part of an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to  Offset to zero  length to zero</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_exec">
void <tt class="descname">rados_write_op_exec</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char<em>&nbsp;*cls</em>, const char<em>&nbsp;*method</em>, const char<em>&nbsp;*in_buf</em>, size_t<em>&nbsp;in_len</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_write_op_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>class method on an object See<a class="reference internal" href="#rados_exec" title="rados_exec"><tt class="xref c c-func docutils literal"><span class="pre">rados_exec()</span></tt></a>for general description.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>cls</strong> &#8211; the name of the class</li>
<li><strong>method</strong> &#8211; the name of the method</li>
<li><strong>in_buf</strong> &#8211; where to find input</li>
<li><strong>in_len</strong> &#8211; length of in_buf in bytes</li>
<li><strong>prval</strong> &#8211; where to store the return value from the method</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_set">
void <tt class="descname">rados_write_op_omap_set</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, char const *const<em>&nbsp;*keys</em>, char const *const<em>&nbsp;*vals</em>, const size_t<em>&nbsp;*lens</em>, size_t<em>&nbsp;num</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set key/value pairs on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>keys</strong> &#8211; array of null-terminated char arrays representing keys to set</li>
<li><strong>vals</strong> &#8211; array of pointers to values to set</li>
<li><strong>lens</strong> &#8211; array of lengths corresponding to each value</li>
<li><strong>num</strong> &#8211; number of key/value pairs to set</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_rm_keys">
void <tt class="descname">rados_write_op_omap_rm_keys</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, char const *const<em>&nbsp;*keys</em>, size_t<em>&nbsp;keys_len</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_rm_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove key/value pairs from an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>keys</strong> &#8211; array of null-terminated char arrays representing keys to remove</li>
<li><strong>keys_len</strong> &#8211; number of key/value pairs to remove</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_clear">
void <tt class="descname">rados_write_op_omap_clear</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all key/value pairs from an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_set_alloc_hint">
void <tt class="descname">rados_write_op_set_alloc_hint</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em><big>)</big><a class="headerlink" href="#rados_write_op_set_alloc_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to add this action to</li>
<li><strong>expected_object_size</strong> &#8211; expected size of the object, in bytes</li>
<li><strong>expected_write_size</strong> &#8211; expected size of writes to the object, in bytes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_operate">
int <tt class="descname">rados_write_op_operate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, time_t<em>&nbsp;*mtime</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a write operation synchronously.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to perform</li>
<li><strong>io</strong> &#8211; the ioctx that the object is in</li>
<li><strong>oid</strong> &#8211; the object id</li>
<li><strong>mtime</strong> &#8211; the time to set the mtime to, NULL for the current time</li>
<li><strong>flags</strong> &#8211; flags to apply to the entire operation (LIBRADOS_OPERATION_*)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write_op_operate">
int <tt class="descname">rados_aio_write_op_operate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char<em>&nbsp;*oid</em>, time_t<em>&nbsp;*mtime</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_aio_write_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a write operation asynchronously.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>write_op</strong> &#8211; operation to perform</li>
<li><strong>io</strong> &#8211; the ioctx that the object is in</li>
<li><strong>completion</strong> &#8211; what to do when operation has been attempted</li>
<li><strong>oid</strong> &#8211; the object id</li>
<li><strong>mtime</strong> &#8211; the time to set the mtime to, NULL for the current time</li>
<li><strong>flags</strong> &#8211; flags to apply to the entire operation (LIBRADOS_OPERATION_*)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_create_read_op">
<a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a> <tt class="descname">rados_create_read_op</tt><big>(</big>void<big>)</big><a class="headerlink" href="#rados_create_read_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new rados_read_op_t write operation.</p>
<p>This will store all actions to be performed atomically. You must call rados_release_read_op when you are finished with it (after it completes, or you decide not to send it in the first place).</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">non-NULL on success, NULL on memory allocation error.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_release_read_op">
void <tt class="descname">rados_release_read_op</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em><big>)</big><a class="headerlink" href="#rados_release_read_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a rados_read_op_t, must be called when you&#8217;re done with it.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to deallocate, created with rados_create_read_op</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_set_flags">
void <tt class="descname">rados_read_op_set_flags</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_read_op_set_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Set flags for the last operation added to this read_op.</p>
<p>At least one op must have been added to the read_op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>flags</strong> &#8211; see librados.h constants beginning with LIBRADOS_OP_FLAG</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_assert_exists">
void <tt class="descname">rados_read_op_assert_exists</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em><big>)</big><a class="headerlink" href="#rados_read_op_assert_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists before reading.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_cmpxattr">
void <tt class="descname">rados_read_op_cmpxattr</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*name</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char<em>&nbsp;*value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_read_op_cmpxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an xattr satisfies a comparison If the comparison is not satisfied, the return code of the operation will be -ECANCELED.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>name</strong> &#8211; name of the xattr to look up</li>
<li><strong>comparison_operator</strong> &#8211; currently undocumented, look for LIBRADOS_CMPXATTR_OP_EQ in librados.h</li>
<li><strong>value</strong> &#8211; buffer to compare actual xattr value to</li>
<li><strong>value_len</strong> &#8211; length of buffer to compare actual xattr value to</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_getxattrs">
void <tt class="descname">rados_read_op_getxattrs</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;*iter</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_getxattrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over xattrs on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>iter</strong> &#8211; where to store the iterator</li>
<li><strong>prval</strong> &#8211; where to store the return value of this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_cmp">
void <tt class="descname">rados_read_op_omap_cmp</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*key</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char<em>&nbsp;*val</em>, size_t<em>&nbsp;val_len</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an omap value satisfies a comparison, with the supplied value on the right hand side (i.e.</p>
<p>for OP_LT, the comparison is actual_value &lt; value.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>key</strong> &#8211; which omap value to compare</li>
<li><strong>comparison_operator</strong> &#8211; one of LIBRADOS_CMPXATTR_OP_EQ, LIBRADOS_CMPXATTR_OP_LT, or LIBRADOS_CMPXATTR_OP_GT</li>
<li><strong>val</strong> &#8211; value to compare with</li>
<li><strong>val_len</strong> &#8211; length of value in bytes</li>
<li><strong>prval</strong> &#8211; where to store the return value from this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_stat">
void <tt class="descname">rados_read_op_stat</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, uint64_t<em>&nbsp;*psize</em>, time_t<em>&nbsp;*pmtime</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get object size and mtime.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>psize</strong> &#8211; where to store object size</li>
<li><strong>pmtime</strong> &#8211; where to store modification time</li>
<li><strong>prval</strong> &#8211; where to store the return value of this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_read">
void <tt class="descname">rados_read_op_read</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, uint64_t<em>&nbsp;offset</em>, size_t<em>&nbsp;len</em>, char<em>&nbsp;*buf</em>, size_t<em>&nbsp;*bytes_read</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bytes from offset into buffer.</p>
<p>prlen will be filled with the number of bytes read if successful. A short read can only occur if the read reaches the end of the object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>offset</strong> &#8211; offset to read from</li>
<li><strong>buffer</strong> &#8211; where to put the data</li>
<li><strong>len</strong> &#8211; length of buffer</li>
<li><strong>prval</strong> &#8211; where to store the return value of this action</li>
<li><strong>bytes_read</strong> &#8211; where to store the number of bytes read by this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_exec">
void <tt class="descname">rados_read_op_exec</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*cls</em>, const char<em>&nbsp;*method</em>, const char<em>&nbsp;*in_buf</em>, size_t<em>&nbsp;in_len</em>, char<em>&nbsp;**out_buf</em>, size_t<em>&nbsp;*out_len</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>class method on an object See<a class="reference internal" href="#rados_exec" title="rados_exec"><tt class="xref c c-func docutils literal"><span class="pre">rados_exec()</span></tt></a>for general description.</p>
<p>The output buffer is allocated on the heap; the caller is expected to release that memory with <a class="reference internal" href="#rados_buffer_free" title="rados_buffer_free"><tt class="xref c c-func docutils literal"><span class="pre">rados_buffer_free()</span></tt></a>. The buffer and length pointers can all be NULL, in which case they are not filled in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>cls</strong> &#8211; the name of the class</li>
<li><strong>method</strong> &#8211; the name of the method</li>
<li><strong>in_buf</strong> &#8211; where to find input</li>
<li><strong>in_len</strong> &#8211; length of in_buf in bytes</li>
<li><strong>out_buf</strong> &#8211; where to put librados-allocated output buffer</li>
<li><strong>out_len</strong> &#8211; length of out_buf in bytes</li>
<li><strong>prval</strong> &#8211; where to store the return value from the method</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_exec_user_buf">
void <tt class="descname">rados_read_op_exec_user_buf</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*cls</em>, const char<em>&nbsp;*method</em>, const char<em>&nbsp;*in_buf</em>, size_t<em>&nbsp;in_len</em>, char<em>&nbsp;*out_buf</em>, size_t<em>&nbsp;out_len</em>, size_t<em>&nbsp;*used_len</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_exec_user_buf" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an <tt class="xref c c-data docutils literal"><span class="pre">OSD</span></tt>class method on an object See<a class="reference internal" href="#rados_exec" title="rados_exec"><tt class="xref c c-func docutils literal"><span class="pre">rados_exec()</span></tt></a>for general description.</p>
<p>If the output buffer is too small, prval will be set to -ERANGE and used_len will be 0.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>cls</strong> &#8211; the name of the class</li>
<li><strong>method</strong> &#8211; the name of the method</li>
<li><strong>in_buf</strong> &#8211; where to find input</li>
<li><strong>in_len</strong> &#8211; length of in_buf in bytes</li>
<li><strong>out_buf</strong> &#8211; user-provided buffer to read into</li>
<li><strong>out_len</strong> &#8211; length of out_buf in bytes</li>
<li><strong>used_len</strong> &#8211; where to store the number of bytes read into out_buf</li>
<li><strong>prval</strong> &#8211; where to store the return value from the method</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_vals">
void <tt class="descname">rados_read_op_omap_get_vals</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*start_after</em>, const char<em>&nbsp;*filter_prefix</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;*iter</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over key/value pairs on an object.</p>
<p>They will be returned sorted by key.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>start_after</strong> &#8211; list keys starting after start_after</li>
<li><strong>filter_prefix</strong> &#8211; list only keys beginning with filter_prefix  max_return list no more than max_return key/value pairs</li>
<li><strong>iter</strong> &#8211; where to store the iterator</li>
<li><strong>prval</strong> &#8211; where to store the return value from this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_keys">
void <tt class="descname">rados_read_op_omap_get_keys</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char<em>&nbsp;*start_after</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;*iter</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over keys on an object.</p>
<p>They will be returned sorted by key, and the iterator will fill in NULL for all values if specified.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>start_after</strong> &#8211; list keys starting after start_after  max_return list no more than max_return keys</li>
<li><strong>iter</strong> &#8211; where to store the iterator</li>
<li><strong>prval</strong> &#8211; where to store the return value from this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_vals_by_keys">
void <tt class="descname">rados_read_op_omap_get_vals_by_keys</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, char const *const<em>&nbsp;*keys</em>, size_t<em>&nbsp;keys_len</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;*iter</em>, int<em>&nbsp;*prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_vals_by_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over specific key/value pairs.</p>
<p>They will be returned sorted by key.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to add this action to</li>
<li><strong>keys</strong> &#8211; array of pointers to null-terminated keys to get</li>
<li><strong>keys_len</strong> &#8211; the number of strings in keys</li>
<li><strong>iter</strong> &#8211; where to store the iterator</li>
<li><strong>prval</strong> &#8211; where to store the return value from this action</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_operate">
int <tt class="descname">rados_read_op_operate</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*oid</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_read_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a read operation synchronously.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to perform  the ioctx that the object is in  the object id  flags to apply to the entire operation (LIBRADOS_OPERATION_*)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_aio_read_op_operate">
int <tt class="descname">rados_aio_read_op_operate</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char<em>&nbsp;*oid</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_aio_read_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a read operation asynchronously.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>read_op</strong> &#8211; operation to perform  the ioctx that the object is in</li>
<li><strong>completion</strong> &#8211; what to do when operation has been attempted  the object id  flags to apply to the entire operation (LIBRADOS_OPERATION_*)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_lock_exclusive">
int <tt class="descname">rados_lock_exclusive</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*cookie</em>, const char<em>&nbsp;*desc</em>, struct timeval<em>&nbsp;*duration</em>, uint8_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_lock_exclusive" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an exclusive lock on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>oid</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; the name of the lock</li>
<li><strong>cookie</strong> &#8211; user-defined identifier for this instance of the lock</li>
<li><strong>desc</strong> &#8211; user-defined lock description</li>
<li><strong>duration</strong> &#8211; the duration of the lock. Set to NULL for infinite duration.</li>
<li><strong>flags</strong> &#8211; lock flags</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-EBUSY if the lock is already held by another (client, cookie) pair</p>
<p>-EEXIST if the lock is already held by the same (client, cookie) pair</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_lock_shared">
int <tt class="descname">rados_lock_shared</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*cookie</em>, const char<em>&nbsp;*tag</em>, const char<em>&nbsp;*desc</em>, struct timeval<em>&nbsp;*duration</em>, uint8_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_lock_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a shared lock on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; the name of the lock</li>
<li><strong>cookie</strong> &#8211; user-defined identifier for this instance of the lock</li>
<li><strong>tag</strong> &#8211; The tag of the lock</li>
<li><strong>desc</strong> &#8211; user-defined lock description</li>
<li><strong>duration</strong> &#8211; the duration of the lock. Set to NULL for infinite duration.</li>
<li><strong>flags</strong> &#8211; lock flags</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-EBUSY if the lock is already held by another (client, cookie) pair</p>
<p>-EEXIST if the lock is already held by the same (client, cookie) pair</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_unlock">
int <tt class="descname">rados_unlock</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*cookie</em><big>)</big><a class="headerlink" href="#rados_unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a shared or exclusive lock on an object.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; the name of the lock</li>
<li><strong>cookie</strong> &#8211; user-defined identifier for the instance of the lock</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ENOENT if the lock is not held by the specified (client, cookie) pair</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_list_lockers">
ssize_t <tt class="descname">rados_list_lockers</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, int<em>&nbsp;*exclusive</em>, char<em>&nbsp;*tag</em>, size_t<em>&nbsp;*tag_len</em>, char<em>&nbsp;*clients</em>, size_t<em>&nbsp;*clients_len</em>, char<em>&nbsp;*cookies</em>, size_t<em>&nbsp;*cookies_len</em>, char<em>&nbsp;*addrs</em>, size_t<em>&nbsp;*addrs_len</em><big>)</big><a class="headerlink" href="#rados_list_lockers" title="Permalink to this definition">¶</a></dt>
<dd><p>List clients that have locked the named object lock and information about the lock.</p>
<p>The number of bytes required in each buffer is put in the corresponding size out parameter. If any of the provided buffers are too short, -ERANGE is returned after these sizes are filled in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; the name of the lock</li>
<li><strong>exclusive</strong> &#8211; where to store whether the lock is exclusive (1) or shared (0)</li>
<li><strong>tag</strong> &#8211; where to store the tag associated with the object lock</li>
<li><strong>tag_len</strong> &#8211; number of bytes in tag buffer</li>
<li><strong>clients</strong> &#8211; buffer in which locker clients are stored, separated by &#8216;\0&#8217;</li>
<li><strong>clients_len</strong> &#8211; number of bytes in the clients buffer</li>
<li><strong>cookies</strong> &#8211; buffer in which locker cookies are stored, separated by &#8216;\0&#8217;</li>
<li><strong>cookies_len</strong> &#8211; number of bytes in the cookies buffer</li>
<li><strong>addrs</strong> &#8211; buffer in which locker addresses are stored, separated by &#8216;\0&#8217;</li>
<li><strong>addrs_len</strong> &#8211; number of bytes in the clients buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>number of lockers on success, negative error code on failure</p>
<p>-ERANGE if any of the buffers are too short</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_break_lock">
int <tt class="descname">rados_break_lock</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char<em>&nbsp;*o</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;*client</em>, const char<em>&nbsp;*cookie</em><big>)</big><a class="headerlink" href="#rados_break_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Releases a shared or exclusive lock on an object, which was taken by the specified client.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>io</strong> &#8211; the context to operate in</li>
<li><strong>o</strong> &#8211; the name of the object</li>
<li><strong>name</strong> &#8211; the name of the lock</li>
<li><strong>client</strong> &#8211; the client currently holding the lock</li>
<li><strong>cookie</strong> &#8211; user-defined identifier for the instance of the lock</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>0 on success, negative error code on failure</p>
<p>-ENOENT if the lock is not held by the specified (client, cookie) pair</p>
<p>-EINVAL if the client cannot be parsed</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_mon_command">
int <tt class="descname">rados_mon_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;**cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char<em>&nbsp;*inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char<em>&nbsp;**outbuf</em>, size_t<em>&nbsp;*outbuflen</em>, char<em>&nbsp;**outs</em>, size_t<em>&nbsp;*outslen</em><big>)</big><a class="headerlink" href="#rados_mon_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Send monitor command.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Takes command string in carefully-formatted JSON; must match defined commands, types, etc.</p>
</div>
The result buffers are allocated on the heap; the caller is expected to release that memory with<a class="reference internal" href="#rados_buffer_free" title="rados_buffer_free"><tt class="xref c c-func docutils literal"><span class="pre">rados_buffer_free()</span></tt></a>. The buffer and length pointers can all be NULL, in which case they are not filled in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
<li><strong>cmd</strong> &#8211; an array of char *&#8217;s representing the command</li>
<li><strong>cmdlen</strong> &#8211; count of valid entries in cmd</li>
<li><strong>inbuf</strong> &#8211; any bulk input data (crush map, etc.)</li>
<li><strong>outbuf</strong> &#8211; double pointer to output buffer</li>
<li><strong>outbuflen</strong> &#8211; pointer to output buffer length</li>
<li><strong>outs</strong> &#8211; double pointer to status string</li>
<li><strong>outslen</strong> &#8211; pointer to status string length</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_mon_command_target">
int <tt class="descname">rados_mon_command_target</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*name</em>, const char<em>&nbsp;**cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char<em>&nbsp;*inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char<em>&nbsp;**outbuf</em>, size_t<em>&nbsp;*outbuflen</em>, char<em>&nbsp;**outs</em>, size_t<em>&nbsp;*outslen</em><big>)</big><a class="headerlink" href="#rados_mon_command_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Send monitor command to a specific monitor.</p>
<p><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Takes command string in carefully-formatted JSON; must match defined commands, types, etc.</p>
</div>
The result buffers are allocated on the heap; the caller is expected to release that memory with<a class="reference internal" href="#rados_buffer_free" title="rados_buffer_free"><tt class="xref c c-func docutils literal"><span class="pre">rados_buffer_free()</span></tt></a>. The buffer and length pointers can all be NULL, in which case they are not filled in.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> &#8211; cluster handle</li>
<li><strong>name</strong> &#8211; target monitor&#8217;s name</li>
<li><strong>cmd</strong> &#8211; an array of char *&#8217;s representing the command</li>
<li><strong>cmdlen</strong> &#8211; count of valid entries in cmd</li>
<li><strong>inbuf</strong> &#8211; any bulk input data (crush map, etc.)</li>
<li><strong>outbuf</strong> &#8211; double pointer to output buffer</li>
<li><strong>outbuflen</strong> &#8211; pointer to output buffer length</li>
<li><strong>outs</strong> &#8211; double pointer to status string</li>
<li><strong>outslen</strong> &#8211; pointer to status string length</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 on success, negative error code on failure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_buffer_free">
void <tt class="descname">rados_buffer_free</tt><big>(</big>char<em>&nbsp;*buf</em><big>)</big><a class="headerlink" href="#rados_buffer_free" title="Permalink to this definition">¶</a></dt>
<dd><p>free a rados-allocated buffer</p>
<p>Release memory allocated by librados calls like <a class="reference internal" href="#rados_mon_command" title="rados_mon_command"><tt class="xref c c-func docutils literal"><span class="pre">rados_mon_command()</span></tt></a>.</p>
<p></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>buf</strong> &#8211; buffer pointer</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rados_osd_command">
int <tt class="descname">rados_osd_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;osdid</em>, const char<em>&nbsp;**cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char<em>&nbsp;*inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char<em>&nbsp;**outbuf</em>, size_t<em>&nbsp;*outbuflen</em>, char<em>&nbsp;**outs</em>, size_t<em>&nbsp;*outslen</em><big>)</big><a class="headerlink" href="#rados_osd_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_pg_command">
int <tt class="descname">rados_pg_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*pgstr</em>, const char<em>&nbsp;**cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char<em>&nbsp;*inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char<em>&nbsp;**outbuf</em>, size_t<em>&nbsp;*outbuflen</em>, char<em>&nbsp;**outs</em>, size_t<em>&nbsp;*outslen</em><big>)</big><a class="headerlink" href="#rados_pg_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_monitor_log">
int <tt class="descname">rados_monitor_log</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char<em>&nbsp;*level</em>, <a class="reference internal" href="#rados_log_callback_t" title="rados_log_callback_t">rados_log_callback_t</a><em>&nbsp;cb</em>, void<em>&nbsp;*arg</em><big>)</big><a class="headerlink" href="#rados_monitor_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/">安装（快速）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">安装（手动）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Ceph 存储集群</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../configuration/">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment/">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/">运维</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/">手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/">故障排除</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">APIs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../librados-intro/">librados 简介</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">librados (C)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">实例：连接并写入一个对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="#io">异步 IO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-calls">API calls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../libradospp/">librados (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/">librados (Python)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Ceph 术语</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../libradospp/" title="LibradosPP (C++)"
             >next</a> |</li>
        <li class="right" >
          <a href="../librados-intro/" title="librados 简介"
             >previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" >Ceph 存储集群 API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>