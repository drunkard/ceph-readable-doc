
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Librbd (Python) &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../../" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="librbd-python">
<h1>Librbd (Python)<a class="headerlink" href="#librbd-python" title="Permalink to this headline">¶</a></h1>
<p>The <cite>rbd</cite> python module provides file-like access to RBD images.</p>
<div class="section" id="example-creating-and-writing-to-an-image">
<h2>Example: Creating and writing to an image<a class="headerlink" href="#example-creating-and-writing-to-an-image" title="Permalink to this headline">¶</a></h2>
<p>To use <cite>rbd</cite>, you must first connect to RADOS and open an IO
context:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cluster</span> <span class="o">=</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s">&#39;my_ceph.conf&#39;</span><span class="p">)</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">ioctx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s">&#39;mypool&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you instantiate an :class:rbd.RBD object, which you use to create the
image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c"># 4 GiB</span>
<span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>To perform I/O on the image, you instantiate an :class:rbd.Image object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">image</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="s">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
<span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>This writes &#8216;foo&#8217; to the first 600 bytes of the image. Note that data
cannot be :type:unicode - <cite>Librbd</cite> does not know how to deal with
characters wider than a :c:type:char.</p>
<p>In the end, you&#8217;ll want to close the image, the IO context and the connection to RADOS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ioctx</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
<p>To be safe, each of these calls would need to be in a separate :finally
block:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cluster</span> <span class="o">=</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s">&#39;my_ceph_conf&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ioctx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s">&#39;my_pool&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c"># 4 GiB</span>
        <span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
            <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">ioctx</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
<p>This can be cumbersome, so the <tt class="xref py py-class docutils literal"><span class="pre">Rados</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">Ioctx</span></tt>, and
<tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt> classes can be used as context managers that close/shutdown
automatically (see <span class="target" id="index-0"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0343"><strong>PEP 343</strong></a>). Using them as context managers, the
above example becomes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s">&#39;my_ceph.conf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cluster</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s">&#39;mypool&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ioctx</span><span class="p">:</span>
        <span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c"># 4 GiB</span>
        <span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s">&#39;myimage&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
            <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-rbd">
<span id="api-reference"></span><h2>API Reference<a class="headerlink" href="#module-rbd" title="Permalink to this headline">¶</a></h2>
<p>This module is a thin wrapper around librbd.</p>
<p>It currently provides all the synchronous methods of librbd that do
not use callbacks.</p>
<p>Error codes from librbd are turned into exceptions that subclass
<tt class="xref py py-class docutils literal"><span class="pre">Error</span></tt>. Almost all methods may raise <tt class="xref py py-class docutils literal"><span class="pre">Error</span></tt>
(the base class of all rbd exceptions), <tt class="xref py py-class docutils literal"><span class="pre">PermissionError</span></tt>
and <tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>, in addition to those documented for the
method.</p>
<p>A number of methods have string arguments, which must not be unicode
to interact correctly with librbd. If unicode is passed to these
methods, a <tt class="xref py py-class docutils literal"><span class="pre">TypeError</span></tt> will be raised.</p>
<dl class="class">
<dt id="rbd.RBD">
<em class="property">class </em><tt class="descclassname">rbd.</tt><tt class="descname">RBD</tt><a class="headerlink" href="#rbd.RBD" title="Permalink to this definition">¶</a></dt>
<dd><p>This class wraps librbd CRUD functions.</p>
<dl class="method">
<dt id="rbd.RBD.clone">
<tt class="descname">clone</tt><big>(</big><em>p_ioctx</em>, <em>p_name</em>, <em>p_snapname</em>, <em>c_ioctx</em>, <em>c_name</em>, <em>features=0</em>, <em>order=None</em><big>)</big><a class="headerlink" href="#rbd.RBD.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone a parent rbd snapshot into a COW sparse child.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p_ioctx</strong> &#8211; the parent context that represents the parent snap</li>
<li><strong>p_name</strong> &#8211; the parent image name</li>
<li><strong>p_snapname</strong> &#8211; the parent image snapshot name</li>
<li><strong>c_ioctx</strong> &#8211; the child context that represents the new clone</li>
<li><strong>c_name</strong> &#8211; the clone (child) name</li>
<li><strong>features</strong> (<em>int</em>) &#8211; bitmask of features to enable; if set, must include layering</li>
<li><strong>order</strong> (<em>int</em>) &#8211; the image is split into (2**order) byte objects</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">TypeError</span></tt></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">FunctionNotSupported</span></tt></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">ArgumentOutOfRange</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.RBD.create">
<tt class="descname">create</tt><big>(</big><em>ioctx</em>, <em>name</em>, <em>size</em>, <em>order=None</em>, <em>old_format=True</em>, <em>features=0</em>, <em>stripe_unit=0</em>, <em>stripe_count=0</em><big>)</big><a class="headerlink" href="#rbd.RBD.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an rbd image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<tt class="xref py py-class docutils literal"><span class="pre">rados.Ioctx</span></tt>) &#8211; the context in which to create the image</li>
<li><strong>name</strong> (<em>str</em>) &#8211; what the image is called</li>
<li><strong>size</strong> (<em>int</em>) &#8211; how big the image is in bytes</li>
<li><strong>order</strong> (<em>int</em>) &#8211; the image is split into (2**order) byte objects</li>
<li><strong>old_format</strong> (<em>bool</em>) &#8211; whether to create an old-style image that
is accessible by old clients, but can&#8217;t
use more advanced features like layering.</li>
<li><strong>features</strong> (<em>int</em>) &#8211; bitmask of features to enable</li>
<li><strong>stripe_unit</strong> (<em>int</em>) &#8211; stripe unit in bytes (default 0 for object size)</li>
<li><strong>stripe_count</strong> (<em>int</em>) &#8211; objects to stripe over before looping</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">TypeError</span></tt></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">FunctionNotSupported</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.RBD.list">
<tt class="descname">list</tt><big>(</big><em>ioctx</em><big>)</big><a class="headerlink" href="#rbd.RBD.list" title="Permalink to this definition">¶</a></dt>
<dd><p>List image names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<tt class="xref py py-class docutils literal"><span class="pre">rados.Ioctx</span></tt>) &#8211; determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list &#8211; a list of image names</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.RBD.remove">
<tt class="descname">remove</tt><big>(</big><em>ioctx</em>, <em>name</em><big>)</big><a class="headerlink" href="#rbd.RBD.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an RBD image. This may take a long time, since it does
not return until every object that comprises the image has
been deleted. Note that all snapshots must be deleted before
the image can be removed. If there are snapshots left,
<tt class="xref py py-class docutils literal"><span class="pre">ImageHasSnapshots</span></tt> is raised. If the image is still
open, or the watch from a crashed client has not expired,
<tt class="xref py py-class docutils literal"><span class="pre">ImageBusy</span></tt> is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<tt class="xref py py-class docutils literal"><span class="pre">rados.Ioctx</span></tt>) &#8211; determines which RADOS pool the image is in</li>
<li><strong>name</strong> (<em>str</em>) &#8211; the name of the image to remove</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageBusy</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">ImageHasSnapshots</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.RBD.rename">
<tt class="descname">rename</tt><big>(</big><em>ioctx</em>, <em>src</em>, <em>dest</em><big>)</big><a class="headerlink" href="#rbd.RBD.rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename an RBD image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<tt class="xref py py-class docutils literal"><span class="pre">rados.Ioctx</span></tt>) &#8211; determines which RADOS pool the image is in</li>
<li><strong>src</strong> (<em>str</em>) &#8211; the current name of the image</li>
<li><strong>dest</strong> (<em>str</em>) &#8211; the new name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.RBD.version">
<tt class="descname">version</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.RBD.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the version number of the <tt class="docutils literal"><span class="pre">librbd</span></tt> C library.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a tuple of <tt class="docutils literal"><span class="pre">(major,</span> <span class="pre">minor,</span> <span class="pre">extra)</span></tt> components of the
librbd version</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rbd.Image">
<em class="property">class </em><tt class="descclassname">rbd.</tt><tt class="descname">Image</tt><big>(</big><em>ioctx</em>, <em>name</em>, <em>snapshot=None</em>, <em>read_only=False</em><big>)</big><a class="headerlink" href="#rbd.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an RBD image. It is used to perform I/O on
the image and interact with snapshots.</p>
<p><strong>Note</strong>: Any method of this class may raise <tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt>
if the image has been deleted.</p>
<dl class="method">
<dt id="rbd.Image.break_lock">
<tt class="descname">break_lock</tt><big>(</big><em>client</em>, <em>cookie</em><big>)</big><a class="headerlink" href="#rbd.Image.break_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a lock held by another rados client.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the resources used by this image object.</p>
<p>After this is called, this object should not be used.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.copy">
<tt class="descname">copy</tt><big>(</big><em>dest_ioctx</em>, <em>dest_name</em><big>)</big><a class="headerlink" href="#rbd.Image.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy the image to another location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dest_ioctx</strong> (<tt class="xref py py-class docutils literal"><span class="pre">rados.Ioctx</span></tt>) &#8211; determines which pool to copy into</li>
<li><strong>dest_name</strong> (<em>str</em>) &#8211; the name of the copy</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.create_snap">
<tt class="descname">create_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.create_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the name of the snapshot</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.diff_iterate">
<tt class="descname">diff_iterate</tt><big>(</big><em>offset</em>, <em>length</em>, <em>from_snapshot</em>, <em>iterate_cb</em>, <em>include_parent=True</em>, <em>whole_object=False</em><big>)</big><a class="headerlink" href="#rbd.Image.diff_iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the changed extents of an image.</p>
<p>This will call iterate_cb with three arguments:</p>
<p>(offset, length, exists)</p>
<p>where the changed extent starts at offset bytes, continues for
length bytes, and is full of data (if exists is True) or zeroes
(if exists is False).</p>
<p>If from_snapshot is None, it is interpreted as the beginning
of time and this generates all allocated extents.</p>
<p>The end version is whatever is currently selected (via set_snap)
for the image.</p>
<p>Raises <tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt> if from_snapshot is after
the currently set snapshot.</p>
<p>Raises <tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt> if from_snapshot is not the name
of a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<em>int</em>) &#8211; start offset in bytes</li>
<li><strong>length</strong> (<em>int</em>) &#8211; size of region to report on, in bytes</li>
<li><strong>from_snapshot</strong> (<em>str or None</em>) &#8211; starting snapshot name, or None</li>
<li><strong>iterate_cb</strong> (<em>function acception arguments for offset,
length, and exists</em>) &#8211; function to call for each extent</li>
<li><strong>include_parent</strong> (<em>bool</em>) &#8211; True if full history diff should include parent</li>
<li><strong>whole_object</strong> (<em>bool</em>) &#8211; True if diff extents should cover whole object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.discard">
<tt class="descname">discard</tt><big>(</big><em>offset</em>, <em>length</em><big>)</big><a class="headerlink" href="#rbd.Image.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the range from the image. It will be logically filled
with zeroes.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.features">
<tt class="descname">features</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the features bitmask of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the features bitmask of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flags">
<tt class="descname">flags</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the flags bitmask of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the flags bitmask of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flatten">
<tt class="descname">flatten</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten clone image (copy all blocks from parent to child)</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flush">
<tt class="descname">flush</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all writes are fully flushed if caching is enabled.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.invalidate_cache">
<tt class="descname">invalidate_cache</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.invalidate_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop any cached data for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.is_exclusive_lock_owner">
<tt class="descname">is_exclusive_lock_owner</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.is_exclusive_lock_owner" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the status of the image exclusive lock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool - true if the image is exclusively locked</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.is_protected_snap">
<tt class="descname">is_protected_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.is_protected_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out whether a snapshot is protected from deletion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the snapshot to check</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">bool - whether the snapshot is protected</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_children">
<tt class="descname">list_children</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.list_children" title="Permalink to this definition">¶</a></dt>
<dd><p>List children of the currently set snapshot (set via set_snap()).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list - a list of (pool name, image name) tuples</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_lockers">
<tt class="descname">list_lockers</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.list_lockers" title="Permalink to this definition">¶</a></dt>
<dd><p>List clients that have locked the image and information
about the lock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul>
<li><tt class="docutils literal"><span class="pre">tag</span></tt> - the tag associated with the lock (every
additional locker must use the same tag)</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">exclusive</span></tt> - boolean indicating whether the</dt>
<dd>lock is exclusive or shared</dd>
</dl>
</li>
<li><tt class="docutils literal"><span class="pre">lockers</span></tt> - a list of (client, cookie, address)
tuples</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_snaps">
<tt class="descname">list_snaps</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.list_snaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the snapshots of an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="../../../rbd/librbdpy/#rbd.SnapIterator" title="rbd.SnapIterator"><tt class="xref py py-class docutils literal"><span class="pre">SnapIterator</span></tt></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_exclusive">
<tt class="descname">lock_exclusive</tt><big>(</big><em>cookie</em><big>)</big><a class="headerlink" href="#rbd.Image.lock_exclusive" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an exclusive lock on the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ImageBusy</span></tt> if a different client or cookie locked it
<tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt> if the same client and cookie locked it</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_shared">
<tt class="descname">lock_shared</tt><big>(</big><em>cookie</em>, <em>tag</em><big>)</big><a class="headerlink" href="#rbd.Image.lock_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a shared lock on the image. The tag must match
that of the existing lockers, if any.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ImageBusy</span></tt> if a different client or cookie locked it
<tt class="xref py py-class docutils literal"><span class="pre">ImageExists</span></tt> if the same client and cookie locked it</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.old_format">
<tt class="descname">old_format</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.old_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out whether the image uses the old RBD format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool - whether the image uses the old RBD format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.overlap">
<tt class="descname">overlap</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the number of overlapping bytes between the image and its parent
image. If open to a snapshot, returns the overlap between the snapshot
and the parent image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the overlap in bytes</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt> if the image doesn&#8217;t have a parent</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.parent_info">
<tt class="descname">parent_info</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.parent_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about a cloned image&#8217;s parent (if any)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple - <tt class="docutils literal"><span class="pre">(pool</span> <span class="pre">name,</span> <span class="pre">image</span> <span class="pre">name,</span> <span class="pre">snapshot</span> <span class="pre">name)</span></tt> components
of the parent image</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt> if the image doesn&#8217;t have a parent</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.protect_snap">
<tt class="descname">protect_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.protect_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a snapshot as protected. This means it can&#8217;t be deleted
until it is unprotected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the snapshot to protect</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.read">
<tt class="descname">read</tt><big>(</big><em>offset</em>, <em>length</em>, <em>fadvise_flags=0</em><big>)</big><a class="headerlink" href="#rbd.Image.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from the image. Raises <tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt> if
part of the range specified is outside the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<em>int</em>) &#8211; the offset to start reading at</li>
<li><strong>length</strong> (<em>int</em>) &#8211; how many bytes to read</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) &#8211; fadvise flags for this read</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">str - the data read</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.remove_snap">
<tt class="descname">remove_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.remove_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the name of the snapshot</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageBusy</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.resize">
<tt class="descname">resize</tt><big>(</big><em>size</em><big>)</big><a class="headerlink" href="#rbd.Image.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the size of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<em>int</em>) &#8211; the new size of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.rollback_to_snap">
<tt class="descname">rollback_to_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.rollback_to_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the image to its contents at a snapshot. This is a
potentially expensive operation, since it rolls back each
object individually.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the snapshot to rollback to</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.set_snap">
<tt class="descname">set_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.set_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot to read from. Writes will raise ReadOnlyImage
while a snapshot is set. Pass None to unset the snapshot
(reads come from the current image) , and allow writing again.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str or None</em>) &#8211; the snapshot to read from, or None to unset the snapshot</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.size">
<tt class="descname">size</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of the image. If open to a snapshot, returns the
size of that snapshot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the size of the image in bytes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stat">
<tt class="descname">stat</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the image. Currently parent pool and
parent name are always -1 and &#8216;&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><tt class="docutils literal"><span class="pre">size</span></tt> (int) - the size of the image in bytes</li>
<li><tt class="docutils literal"><span class="pre">obj_size</span></tt> (int) - the size of each object that comprises the
image</li>
<li><tt class="docutils literal"><span class="pre">num_objs</span></tt> (int) - the number of objects in the image</li>
<li><tt class="docutils literal"><span class="pre">order</span></tt> (int) - log_2(object_size)</li>
<li><tt class="docutils literal"><span class="pre">block_name_prefix</span></tt> (str) - the prefix of the RADOS objects used
to store the image</li>
<li><tt class="docutils literal"><span class="pre">parent_pool</span></tt> (int) - deprecated</li>
<li><tt class="docutils literal"><span class="pre">parent_name</span></tt>  (str) - deprecated</li>
</ul>
<p>See also <tt class="xref py py-meth docutils literal"><span class="pre">format()</span></tt> and <a class="reference internal" href="../../../rbd/librbdpy/#rbd.Image.features" title="rbd.Image.features"><tt class="xref py py-meth docutils literal"><span class="pre">features()</span></tt></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stripe_count">
<tt class="descname">stripe_count</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.stripe_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the stripe count used for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stripe_unit">
<tt class="descname">stripe_unit</tt><big>(</big><big>)</big><a class="headerlink" href="#rbd.Image.stripe_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the stripe unit used for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.unlock">
<tt class="descname">unlock</tt><big>(</big><em>cookie</em><big>)</big><a class="headerlink" href="#rbd.Image.unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a lock on the image that was locked by this rados client.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.unprotect_snap">
<tt class="descname">unprotect_snap</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#rbd.Image.unprotect_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a snapshot unprotected. This allows it to be deleted if
it was protected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; the snapshot to unprotect</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">ImageNotFound</span></tt></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.update_features">
<tt class="descname">update_features</tt><big>(</big><em>features</em>, <em>enabled</em><big>)</big><a class="headerlink" href="#rbd.Image.update_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the features bitmask of the image by enabling/disabling
a single feature.  The feature must support the ability to be
dynamically enabled/disabled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>features</strong> (<em>int</em>) &#8211; feature bitmask to enable/disable</li>
<li><strong>enabled</strong> (<em>bool</em>) &#8211; whether to enable/disable the feature</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.write">
<tt class="descname">write</tt><big>(</big><em>data</em>, <em>offset</em>, <em>fadvise_flags=0</em><big>)</big><a class="headerlink" href="#rbd.Image.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to the image. Raises <tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt> if
part of the write would fall outside the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>str</em>) &#8211; the data to be written</li>
<li><strong>offset</strong> (<em>int</em>) &#8211; where to start writing data</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) &#8211; fadvise flags for this write</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int - the number of bytes written</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises :</th><td class="field-body"><p class="first last"><tt class="xref py py-class docutils literal"><span class="pre">IncompleteWriteError</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">LogicError</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">InvalidArgument</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">IOError</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rbd.SnapIterator">
<em class="property">class </em><tt class="descclassname">rbd.</tt><tt class="descname">SnapIterator</tt><big>(</big><em>image</em><big>)</big><a class="headerlink" href="#rbd.SnapIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over snapshot info for an image.</p>
<p>Yields a dictionary containing information about a snapshot.</p>
<p>Keys are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">id</span></tt> (int) - numeric identifier of the snapshot</li>
<li><tt class="docutils literal"><span class="pre">size</span></tt> (int) - size of the image at the time of snapshot (in bytes)</li>
<li><tt class="docutils literal"><span class="pre">name</span></tt> (str) - name of the snapshot</li>
</ul>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/">安装（快速）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">安装（手动）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">发布时间表</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Ceph 术语</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2014, Inktank Storage, Inc. and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>