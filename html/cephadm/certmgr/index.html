

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Certificate Management &mdash; Ceph Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/ceph.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/ceph.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="升级 Ceph" href="../upgrade/" />
    <link rel="prev" title="OAuth2 Proxy" href="../services/oauth2-proxy/" /> 
</head>

<body class="wy-body-for-nav">

   
  <header class="top-bar">
    <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../">Cephadm</a></li>
      <li class="breadcrumb-item active">Certificate Management</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/cephadm/certmgr.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
  </header>
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #eee" >
          

          
            <a href="../../" class="icon icon-home"> Ceph
          

          
          </a>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装 Ceph</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Cephadm</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../compatibility/">Compatibility and Stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/">Using Cephadm to Deploy a New Ceph Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adoption/">现有集群切换到 cephadm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../host-management/">Host Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/">Service Management</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Certificate Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#certificate-management-behavior">Certificate Management Behavior</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#self-signed-certificates">Self-Signed Certificates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-provided-certificates">User-Provided Certificates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#certificate-health-monitoring">Certificate Health Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spec-fields-for-ssl-configuration">Spec Fields for SSL Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#certificate-scopes">Certificate Scopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-certificates">Listing Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-entities">Listing Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-certificate-status">Checking Certificate Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#listing-certificate-keys">Listing Certificate Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieving-a-certificate">Retrieving a Certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retrieving-a-certificate-key">Retrieving a Certificate Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-a-certificate-key-pair">Setting a Certificate-Key Pair</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-a-certificate">Setting a Certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-a-private-key">Setting a Private Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removing-a-certificate">Removing a Certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removing-a-private-key">Removing a Private Key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-certificates">Generating Certificates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/">升级 Ceph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../operations/">Cephadm operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client-setup/">Client Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev/cephadm/">Cephadm Feature Planning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../monitoring/">监控概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crimson/crimson/">Crimson (Tech Preview)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware-monitoring/">硬件监控</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jaegertracing/">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Ceph</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<div id="dev-warning" class="admonition note">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="padding: 5px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="certificate-management">
<span id="orchestrator-cli-cert-management"></span><h1>Certificate Management<a class="headerlink" href="#certificate-management" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>Cephadm <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> acts as the Root Certificate Authority (CA) for all
self-signed certificates generated by Cephadm. For services that require
SSL, admins have the option to either bring their own certificate or allow
Cephadm to generate a self-signed certificate. This ensures secure communication
while offering flexibility for deployment preferences.</p>
</section>
<section id="certificate-management-behavior">
<h2>Certificate Management Behavior<a class="headerlink" href="#certificate-management-behavior" title="Permalink to this heading"></a></h2>
<p>Cephadm <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> automatically detects whether a certificate is self-signed (generated
by Cephadm) or user-provided as an embedded value in the spec, or referenced externally.
This distinction determines how it handles expirations and renewals:</p>
<section id="self-signed-certificates">
<h3>Self-Signed Certificates<a class="headerlink" href="#self-signed-certificates" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">certmgr</span></code> can fully automate renewal, ensuring seamless service operation.</p></li>
<li><p>Automation is controlled by configuration parameters defining certificate
duration, renewal thresholds, and whether automated rotation is enabled.</p></li>
</ul>
</section>
<section id="user-provided-certificates">
<h3>User-Provided Certificates<a class="headerlink" href="#user-provided-certificates" title="Permalink to this heading"></a></h3>
<p>There are two types:</p>
<ul class="simple">
<li><p>Inline: Certificates embedded in the service spec; cannot be modified directly via <code class="docutils literal notranslate"><span class="pre">certmgr</span></code>.</p></li>
<li><p>Reference: Certificates set and managed via <code class="docutils literal notranslate"><span class="pre">certmgr</span></code>; must be manually uploaded.</p></li>
</ul>
<p>See <a class="reference internal" href="#certificate-health-monitoring">Certificate Health Monitoring</a> for details on how <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> handles user-provided certificate expiration.</p>
</section>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>To manage certificate lifecycles, <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> continuously monitors
certificates and applies renewal policies based on the certificate type and
configured parameters. Cephadm provides several configuration options to manage
certificate lifecycle and renewal:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mgr/cephadm/certificate_automated_rotation_enabled</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>):
Enabled by default, this configuration option controls whether Cephadm
automatically rotates certificates upon expiration. This helps ensure
continuity and security without manual intervention. When disabled cephadm
will still check periodically the certificates but instead of automatically
renewing self-signed expired ones it will issue a health error/warning when
an issue is detected.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mgr/cephadm/certificate_duration_days</span></code> (default: <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">*</span> <span class="pre">365</span></code>, min: <code class="docutils literal notranslate"><span class="pre">90</span></code>,
max: <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">*</span> <span class="pre">365</span></code>): Specifies the duration (in days) of self-signed
certificates generated and signed by the Cephadm root CA. This determines the
validity period before renewal is required.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mgr/cephadm/certificate_renewal_threshold_days</span></code> (default: <code class="docutils literal notranslate"><span class="pre">30</span></code>, min:
<code class="docutils literal notranslate"><span class="pre">10</span></code>, max: <code class="docutils literal notranslate"><span class="pre">90</span></code>): Defines the number of days before a certificate’s
expiration when Cephadm should initiate renewal. This ensures timely
replacement before expiration occurs. This applies to both self-signed and
user-provided certificates. In the case of user-provided certificates,
Cephadm will issue a health error or warning alerting administrators about
the upcoming renewal period proximity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mgr/cephadm/certificate_check_period</span></code> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>, min: <code class="docutils literal notranslate"><span class="pre">0</span></code>, max:
<code class="docutils literal notranslate"><span class="pre">30</span></code>): Specifies how often (in days) the certificate should be checked for
validity.  This ensures timely detection of any issues related to certificate
expiration.  Setting this to <code class="docutils literal notranslate"><span class="pre">0</span></code> disables the certificate check
functionality.</p></li>
</ul>
</section>
<section id="certificate-health-monitoring">
<h2>Certificate Health Monitoring<a class="headerlink" href="#certificate-health-monitoring" title="Permalink to this heading"></a></h2>
<p>Cephadm continuously monitors the status of all managed certificates, both self-signed and user-provided.</p>
<ul class="simple">
<li><p>If a certificate is invalid or has already expired, Cephadm issues a health
error (<code class="docutils literal notranslate"><span class="pre">CEPHADM_CERT_ERROR</span></code>) to alert administrators.</p></li>
<li><p>If a certificate is approaching its expiration date, as determined by the
configured <code class="docutils literal notranslate"><span class="pre">mgr/cephadm/certificate_renewal_threshold_days</span></code>, Cephadm issues a
health warning.</p></li>
</ul>
<p>Self-signed certificates are automatically renewed by Cephadm if automation is enabled, but
user-provided certificates cannot be renewed automatically. In either case, Cephadm alerts
administrators so they can take timely action. This proactive monitoring helps ensure
uninterrupted service operation while giving users control over their certificate policies.</p>
</section>
<section id="spec-fields-for-ssl-configuration">
<h2>Spec Fields for SSL Configuration<a class="headerlink" href="#spec-fields-for-ssl-configuration" title="Permalink to this heading"></a></h2>
<p>All service specs that support SSL/TLS may optionally define the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ssl</span></code>: Boolean to enable/disable SSL.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl_cert</span></code>: Certificate content (for <code class="docutils literal notranslate"><span class="pre">inline</span></code>) or name (for <code class="docutils literal notranslate"><span class="pre">reference</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl_key</span></code>: Key content (for <code class="docutils literal notranslate"><span class="pre">inline</span></code>) or name (for <code class="docutils literal notranslate"><span class="pre">reference</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">certificate_source</span></code>: One of <code class="docutils literal notranslate"><span class="pre">inline</span></code>, <code class="docutils literal notranslate"><span class="pre">reference</span></code>, or <code class="docutils literal notranslate"><span class="pre">cephadm_signed</span></code>.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">certificate_source</span></code> is <code class="docutils literal notranslate"><span class="pre">reference</span></code> and the certificate is missing, users will need
to upload the certificate by using the following <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "# ";
}
</style><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--cert-name<span class="w"> </span>&lt;cert-name&gt;<span class="w"> </span>--service-name<span class="w"> </span>&lt;service-name&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;cert-key-pem-file&gt;</span>
</pre></div></div></section>
<section id="certificate-scopes">
<h2>Certificate Scopes<a class="headerlink" href="#certificate-scopes" title="Permalink to this heading"></a></h2>
<p>Cephadm <code class="docutils literal notranslate"><span class="pre">certmgr</span></code> supports three different scopes for certificate management:</p>
<ol class="arabic simple">
<li><p><strong>Global Scope:</strong></p>
<ul class="simple">
<li><p>Certificates in this scope are shared across all service daemons, regardless of which host they are running on.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">mgmt-gateway</span></code> certificate is a globally shared certificate used by all service daemons.</p></li>
</ul>
</li>
<li><p><strong>Per-Host Scope:</strong></p>
<ul class="simple">
<li><p>Certificates are assigned per host, meaning each host has its own unique certificate.</p></li>
<li><p>When configuring a custom certificate, the user must specify the host for which the certificate applies.</p></li>
<li><p>Example: <code class="docutils literal notranslate"><span class="pre">grafana</span></code> service certificates are configured at the host level and apply specifically to a single machine.</p></li>
</ul>
</li>
<li><p><strong>Per-Service Scope:</strong></p>
<ul class="simple">
<li><p>Certificates are configured per service name (each service instance can have its own certificate).</p></li>
<li><p>When specifying a custom certificate, the user must define the service to which it belongs.</p></li>
<li><p>Example: an <code class="docutils literal notranslate"><span class="pre">rgw</span></code> service certificate is assigned specifically and only to an RGW service</p></li>
</ul>
</li>
</ol>
</section>
<section id="listing-certificates">
<h2>Listing Certificates<a class="headerlink" href="#listing-certificates" title="Permalink to this heading"></a></h2>
<p>To list all certificates managed by Cephadm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>ls<span class="w"> </span><span class="o">[</span>--show-details<span class="o">]</span><span class="w"> </span><span class="o">[</span>--include-cephadm-signed<span class="o">]</span><span class="w"> </span><span class="o">[</span>--filter-by<span class="w"> </span>&lt;expression&gt;<span class="o">]</span></span>
</pre></div></div><p>This command displays an overview of all certificates currently managed by
Cephadm. The <code class="docutils literal notranslate"><span class="pre">--show-details</span></code> option includes additional information such as
issuing authorities and certificate extensions.</p>
<p>By default, this command omits Cephadm-signed certificates. To include them,
pass the <code class="docutils literal notranslate"><span class="pre">--include-cephadm-signed</span></code> argument.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>ls<span class="w"> </span>--include-cephadm-signed</span>
<span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>ls<span class="w"> </span>--filter-by<span class="w"> </span><span class="s2">&quot;status=expired&quot;</span></span>
<span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>ls<span class="w"> </span>--filter-by<span class="w"> </span><span class="s2">&quot;scope=service,status=expiring&quot;</span></span>
<span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>ls<span class="w"> </span>--include-cephadm-signed<span class="w"> </span>--filter-by<span class="w"> </span><span class="s2">&quot;name=rgw*,status=valid&quot;</span></span>
</pre></div></div></section>
<section id="listing-entities">
<h2>Listing Entities<a class="headerlink" href="#listing-entities" title="Permalink to this heading"></a></h2>
<p>Displays all entities that are associated with managed certificates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>bindings<span class="w"> </span>ls</span>
</pre></div></div><p>List all current certificate bindings between consumers (services) and
the certificates/keys managed by certmgr.</p>
</section>
<section id="checking-certificate-status">
<h2>Checking Certificate Status<a class="headerlink" href="#checking-certificate-status" title="Permalink to this heading"></a></h2>
<p>To check the status and validity of a specific certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>check</span>
</pre></div></div><p>This command verifies the integrity and expiration status of all managed certificates.</p>
</section>
<section id="listing-certificate-keys">
<h2>Listing Certificate Keys<a class="headerlink" href="#listing-certificate-keys" title="Permalink to this heading"></a></h2>
<p>To list all private keys associated with managed certificates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>key<span class="w"> </span>ls<span class="w"> </span><span class="o">[</span>--include-cephadm-signed<span class="o">]</span></span>
</pre></div></div><p>This command shows which keys are currently managed by cephadm. By default, this command omits
Cephadm-signed keys. To include them, pass the <code class="docutils literal notranslate"><span class="pre">--include-cephadm-signed</span></code> argument.</p>
</section>
<section id="retrieving-a-certificate">
<h2>Retrieving a Certificate<a class="headerlink" href="#retrieving-a-certificate" title="Permalink to this heading"></a></h2>
<p>To retrieve the content of a specific certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>get<span class="w"> </span>&lt;certificate_name&gt;<span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--no-exception-when-missing<span class="o">]</span></span>
</pre></div></div><p>Use <code class="docutils literal notranslate"><span class="pre">&lt;service-name&gt;</span></code> as listed by <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">orch</span> <span class="pre">certmgr</span> <span class="pre">bindings</span> <span class="pre">ls</span></code>. For certificates with host or service scope,
include the <code class="docutils literal notranslate"><span class="pre">--hostname</span></code> or <code class="docutils literal notranslate"><span class="pre">--service_name</span></code> arguments as needed.</p>
</section>
<section id="retrieving-a-certificate-key">
<h2>Retrieving a Certificate Key<a class="headerlink" href="#retrieving-a-certificate-key" title="Permalink to this heading"></a></h2>
<p>To retrieve the private key associated with a specific certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>key<span class="w"> </span>get<span class="w"> </span>&lt;key_name&gt;<span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--no-exception-when-missing<span class="o">]</span></span>
</pre></div></div><p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;key-name&gt;</span></code> with the actual certificate name from <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">orch</span> <span class="pre">certmgr</span> <span class="pre">key</span> <span class="pre">ls</span></code>.
For certificates with host or service scope, include
the <code class="docutils literal notranslate"><span class="pre">--hostname</span></code> or <code class="docutils literal notranslate"><span class="pre">--service_name</span></code> arguments as needed.</p>
</section>
<section id="setting-a-certificate-key-pair">
<h2>Setting a Certificate-Key Pair<a class="headerlink" href="#setting-a-certificate-key-pair" title="Permalink to this heading"></a></h2>
<p>To associate a certificate with a private key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert-key<span class="w"> </span><span class="nb">set</span><span class="w"> </span>&lt;service-type&gt;<span class="w"> </span><span class="o">[</span>--cert<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--key<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span>&lt;cert-key-path&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--force<span class="o">]</span></span>
</pre></div></div><p>Use this command to upload or replace an existing certificate/key pair for a certain service.
Replace <code class="docutils literal notranslate"><span class="pre">&lt;service-type&gt;</span></code> with the actual certificate name from <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">orch</span> <span class="pre">certmgr</span> <span class="pre">bindings</span> <span class="pre">ls</span></code>.
The <code class="docutils literal notranslate"><span class="pre">-i</span></code> option can be used to specify a file containing a combined certificate and key in
PEM format. This file should include both the certificate and private key concatenated together.</p>
</section>
<section id="setting-a-certificate">
<h2>Setting a Certificate<a class="headerlink" href="#setting-a-certificate" title="Permalink to this heading"></a></h2>
<p>To update or set a new certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span><span class="nb">set</span><span class="w"> </span>&lt;certificate_name&gt;<span class="w"> </span><span class="o">[</span>--cert<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span>&lt;cert-path&gt;<span class="o">]</span></span>
</pre></div></div><p>Use this command to add or replace an existing certificate.</p>
</section>
<section id="setting-a-private-key">
<h2>Setting a Private Key<a class="headerlink" href="#setting-a-private-key" title="Permalink to this heading"></a></h2>
<p>To update or set a new private key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>key<span class="w"> </span><span class="nb">set</span><span class="w"> </span>&lt;key-name&gt;<span class="w"> </span><span class="o">[</span>--key<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>-i<span class="w"> </span>&lt;key-path&gt;<span class="o">]</span></span>
</pre></div></div><p>This command allows administrators to provide new private keys for services.</p>
</section>
<section id="removing-a-certificate">
<h2>Removing a Certificate<a class="headerlink" href="#removing-a-certificate" title="Permalink to this heading"></a></h2>
<p>To remove an existing certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>cert<span class="w"> </span>rm<span class="w"> </span>&lt;certificate_name&gt;<span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span></span>
</pre></div></div><p><strong>Note:</strong> For certificates with host or service scope, use the <code class="docutils literal notranslate"><span class="pre">--service-name</span></code> or <code class="docutils literal notranslate"><span class="pre">--hostname</span></code> option to specify the target.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;certificate_name&gt;</span></code> must be a valid certificate name. Use <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">orch</span> <span class="pre">certmgr</span> <span class="pre">cert</span> <span class="pre">ls</span></code> to list supported certificates.</p>
</section>
<section id="removing-a-private-key">
<h2>Removing a Private Key<a class="headerlink" href="#removing-a-private-key" title="Permalink to this heading"></a></h2>
<p>To remove an existing private key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>key<span class="w"> </span>rm<span class="w"> </span>&lt;key-name&gt;<span class="w"> </span><span class="o">[</span>--service_name<span class="w"> </span>&lt;value&gt;<span class="o">]</span><span class="w"> </span><span class="o">[</span>--hostname<span class="w"> </span>&lt;value&gt;<span class="o">]</span></span>
</pre></div></div><p><strong>Note:</strong> For keys with host or service scope, use the <code class="docutils literal notranslate"><span class="pre">--service-name</span></code> or <code class="docutils literal notranslate"><span class="pre">--hostname</span></code> option to specify the target.</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;key_name&gt;</span></code> must be a valid key name. Use <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">orch</span> <span class="pre">certmgr</span> <span class="pre">key</span> <span class="pre">ls</span></code> to list supported keys.</p>
</section>
<section id="generating-certificates">
<h2>Generating Certificates<a class="headerlink" href="#generating-certificates" title="Permalink to this heading"></a></h2>
<p>To automatically generate a new certificate and key pair:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ceph<span class="w"> </span>orch<span class="w"> </span>certmgr<span class="w"> </span>generate-certificates<span class="w"> </span>&lt;module_name&gt;</span>
</pre></div></div><p>This command provisions new certificates for specified Manager <code class="docutils literal notranslate"><span class="pre">module</span></code>. It is typically used
for the specified modules that require automatic TLS provisioning (e.g., dashboard).</p>
</section>
</section>



<div id="support-the-ceph-foundation" class="admonition note">
  <p class="first admonition-title">Brought to you by the Ceph Foundation</p>
  <p class="last">The Ceph Documentation is a community resource funded and hosted by the non-profit <a href="https://ceph.io/en/foundation/">Ceph Foundation</a>. If you would like to support this and our other efforts, please consider <a href="https://ceph.io/en/foundation/join/">joining now</a>.</p>
</div>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../services/oauth2-proxy/" class="btn btn-neutral float-left" title="OAuth2 Proxy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../upgrade/" class="btn btn-neutral float-right" title="升级 Ceph" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).</p>
  </div>

   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>